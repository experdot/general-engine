!function o(a,s,c){function u(t,e){if(!s[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var i=s[t]={exports:{}};a[t][0].call(i.exports,function(e){return u(a[t][1][e]||e)},i,i.exports,o,a,s,c)}return s[t].exports}for(var l="function"==typeof require&&require,e=0;e<c.length;e++)u(c[e]);return u}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(){}return t.show=function(e){void 0===e&&(e=""),t.onNotify(e)},t}();(n.MessageBox=r).onNotify=function(e){window.alert(e)}},{}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){void 0===e&&(e=1),void 0===t&&(t=1),this.width=e,this.height=t,this.data=[];for(var n=0;n<e;n++){this.data.push([]);for(var r=0;r<t;r++)this.data[n][r]=void 0}}return e.prototype.set=function(e,t,n){return this.data[e][t]=n,this.data[e][t]},e.prototype.get=function(e,t){return this.data[e][t]},e.prototype.forEach=function(r){this.data.forEach(function(e,n){e&&e.forEach(function(e,t){r&&r(e,n,t)})})},e}();n.Array2=r},{}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.reset()}return e.prototype.reset=function(){return this.lastTime=(new Date).getTime(),this},e.prototype.delay=function(e,t,n){var r=(new Date).getTime(),i=r-this.lastTime;e<=i?(this.lastTime=r,t&&t(i)):n&&n(i)},e}();n.DelayTimer=r},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i,o=e("./Exception");(i=r=n.StrictMode||(n.StrictMode={}))[i.None=0]="None",i[i.Strict=1]="Strict";var a=function(){function e(e){void 0===e&&(e=r.None),this.mode=e,this.handlers={},this.dom0Events=[],this.dom2Events=[]}return e.prototype.addHandler=function(e,t,n){if(void 0===n&&(n=!1),(this.mode===r.None||n)&&this.registEvent(e),!this.handlers[e])throw new o.InvalidOperationException("The event is not registed.");return this.handlers[e].push(t),t},e.prototype.removeHandler=function(e,t){var n=this.handlers[e];if(n&&0<n.length){var r=n.findIndex(function(e){return e===t});0<=r&&n.splice(r,1)}},e.prototype.registEvent=function(e){this.handlers[e]||(this.handlers[e]=[])},e.prototype.registEventDomLevel0=function(e,t,n){var r=this;this.handlers[t]||(this.handlers[t]=[],n&&e&&(e[n]=function(e){r.raiseEvent(t,e)},this.dom0Events.push({ui:e,name:n})))},e.prototype.registEventDomLevel2=function(e,t,n,r){var i=this;if(!this.handlers[t]&&(this.handlers[t]=[],n&&e)){var o=function(e){i.raiseEvent(t,e)};e.addEventListener(n,o,r),this.dom2Events.push({ui:e,name:n,listener:o})}},e.prototype.raiseEvent=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.handlers[e]&&this.handlers[e].forEach(function(e){e.apply(void 0,t)})},e.prototype.release=function(){this.handlers={},this.dom0Events.forEach(function(e){e.ui[e.name]=null}),this.dom2Events.forEach(function(e){e.ui.removeEventListener(e.name,e.listener)})},e}();n.Events=a},{"./Exception":5}],5:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){this.message=e},a=function(t){function e(e){return void 0===e&&(e="One of the arguments provided to a method is not valid."),t.call(this,e)||this}return i(e,t),e}(n.Exception=o),s=function(t){function e(e){return void 0===e&&(e="An undefined/null reference is passed to a method that does not accept it as a valid argument."),t.call(this,e)||this}return i(e,t),e}(n.ArgumentException=a);n.ArgumentNullException=s;var c=function(t){function e(e){return void 0===e&&(e="The value of an argument is outside the allowable range of values as defined by the invoked method."),t.call(this,e)||this}return i(e,t),e}(a);n.ArgumentOutOfRangeException=c;var u=function(t){function e(e){return void 0===e&&(e="An attempt is made to access an element of an array or collection with an index that is outside its bounds."),t.call(this,e)||this}return i(e,t),e}(o);n.IndexOutOfRangeException=u;var l=function(t){function e(e){return void 0===e&&(e="A method call is invalid for the object's current state."),t.call(this,e)||this}return i(e,t),e}(o);n.InvalidOperationException=l;var f=function(t){function e(e){return void 0===e&&(e="The key specified for accessing an element in an object does not match any key in the object."),t.call(this,e)||this}return i(e,t),e}(o);n.KeyNotFoundException=f;var h=function(t){function e(e){return void 0===e&&(e="The method is not implemented."),t.call(this,e)||this}return i(e,t),e}(o);n.NotImplementedException=h;var p=function(t){function e(e){return void 0===e&&(e="An invoked method is not supported."),t.call(this,e)||this}return i(e,t),e}(o);n.NotSupportedException=p;var d=function(t){function e(e){return void 0===e&&(e="A feature does not run on a particular platform."),t.call(this,e)||this}return i(e,t),e}(o);n.PlatformNotSupportedException=d;var y=function(t){function e(e){return void 0===e&&(e="An array with the wrong number of dimensions is passed to a method."),t.call(this,e)||this}return i(e,t),e}(o);n.RankException=y;var v=function(t){function e(e){return void 0===e&&(e="The time interval allotted to an operation has expired."),t.call(this,e)||this}return i(e,t),e}(o);n.TimeoutException=v},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return Object.defineProperty(e,"Unique",{get:function(){return e.unique++},enumerable:!0,configurable:!0}),e.unique=1,e}();n.Identifier=r},{}],7:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o,a,s=e("./Exception"),c=e("../Numerics/Vector2");(a=o=n.InputEvents||(n.InputEvents={})).Click="Click",a.MouseDown="MouseDown",a.MouseUp="MouseUp",a.MouseMove="MouseMove",a.MouseEnter="MouseEnter",a.MouseLeave="MouseLeave",a.MouseWheel="MouseWheel",a.Tap="Tap",a.TouchStart="TouchStart",a.TouchEnd="TouchEnd",a.TouchMove="TouchMove",a.PointerClicked="PointerClicked",a.PointerPressed="PointerPressed",a.PointerReleased="PointerReleased",a.PointerMoved="PointerMoved",a.PointerEntered="PointerEntered",a.PointerExited="PointerExited",a.PointerWheelChanged="PointerWheelChanged",a.KeyDown="KeyDown",a.KeyUp="KeyUp",a.KeyPress="KeyPress",a.Drop="Drop",a.DragEnter="DragEnter",a.DragExit="DragExit",a.DragOver="DragOver";var u=function(){function e(){this.inputList=[],this.dispatcher=function(){throw new s.NotImplementedException("The dispatcher event handler is not configured.")}}return e.prototype.change=function(e){return this.dispatcher=e,this},e.prototype.launch=function(e){var t=this;return this.release(),this.ui=e,this.inputList.forEach(function(e){t.regist(e)}),this},e.prototype.release=function(){this.inputList.forEach(function(e){e.release()}),this.ui=null},e.prototype.regist=function(e){e.regist(this)},e.prototype.addInput=function(e){this.inputList.push(e)},e}();n.Inputs=u;var l=function(){function e(){this.events=[]}return e.prototype.regist=function(e){this.inputs=e},e.prototype.registEvent=function(e,t,n,r,i){var o=this;void 0===i&&(i=null);var a=function(e){n&&n(e),o.inputs.dispatcher(t,e),r&&r(e)};(i=i||this.inputs.ui).addEventListener(e,a),this.events.push({ui:i,name:e,listener:a})},e.prototype.release=function(){this.events.forEach(function(e){e.ui.removeEventListener(e.name,e.listener)})},e}(),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.regist=function(e){t.prototype.regist.call(this,e),e.mouse||(e.mouse={isPressed:!1,position:new c.Vector2(0,0)}),this._registMouseEvent(e)},e.prototype._registMouseEvent=function(t){this.registEvent("click",o.Click),this.registEvent("mouseenter",o.MouseEnter),this.registEvent("mouseleave",o.MouseLeave,function(){t.mouse.isPressed=!1}),this.registEvent("mousedown",o.MouseDown,function(){t.mouse.isPressed=!0}),this.registEvent("mouseup",o.MouseUp,function(){t.mouse.isPressed=!1}),this.registEvent("mousemove",o.MouseMove,function(e){t.mouse.position=new c.Vector2(e.offsetX,e.offsetY)});var e=function(e){t.dispatcher&&t.dispatcher(o.MouseWheel,e)};window.onmousewheel=e,document.onmousewheel=e},e}(n.InputBase=l);n.MouseInput=f;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.regist=function(e){t.prototype.regist.call(this,e),e.touch||(e.touch={isTouching:!1,position:new c.Vector2(0,0)}),this._registTouchEvent(e)},e.prototype._registTouchEvent=function(t){this.registEvent("tap",o.Tap),this.registEvent("touchStart",o.TouchStart,function(){t.touch.isTouching=!0}),this.registEvent("touchEnd",o.TouchEnd,function(){t.touch.isTouching=!1}),this.registEvent("touchmove",o.TouchMove,function(e){e.preventDefault(),t.touch.position=new c.Vector2(e.changedTouches[0].clientX,e.changedTouches[0].clientY)})},e}(l);n.TouchInput=h;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.regist=function(e){t.prototype.regist.call(this,e),e.pointer||(e.pointer={isPressed:!1,position:new c.Vector2(0,0)}),this._registMouseEvent(e),this._registTouchEvent(e)},e.prototype._registMouseEvent=function(t){this.registEvent("click",o.PointerClicked),this.registEvent("mouseenter",o.PointerEntered),this.registEvent("mouseleave",o.PointerExited,function(){t.pointer.isPressed=!1}),this.registEvent("mousedown",o.PointerPressed,function(){t.pointer.isPressed=!0}),this.registEvent("mouseup",o.PointerReleased,function(){t.pointer.isPressed=!1}),this.registEvent("mousemove",o.PointerMoved,function(e){t.pointer.position=new c.Vector2(e.offsetX,e.offsetY)});var e=function(e){t.dispatcher&&t.dispatcher(o.MouseWheel,e)};window.onmousewheel=e,document.onmousewheel=e},e.prototype._registTouchEvent=function(t){this.registEvent("tap",o.PointerClicked),this.registEvent("touchstart",o.PointerPressed,function(){t.pointer.isPressed=!0}),this.registEvent("touchend",o.PointerReleased,function(){t.pointer.isPressed=!1}),this.registEvent("touchmove",o.PointerMoved,function(e){e.preventDefault(),t.pointer.isPressed=!0,t.pointer.position=new c.Vector2(e.changedTouches[0].clientX,e.changedTouches[0].clientY)})},e}(l);n.PointerInput=p;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.regist=function(e){t.prototype.regist.call(this,e),e.key||(e.key={isKeyDown:!1}),this.registEvent("keydown",o.KeyDown,function(){e.key.isKeyDown=!0},null,document.body),this.registEvent("keyup",o.KeyUp,function(){e.key.isKeyDown=!1},null,document.body),this.registEvent("keypress",o.KeyPress,null,null,document.body)},e}(l);n.KeyInput=d;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.regist=function(e){t.prototype.regist.call(this,e),this.registEvent("drop",o.Drop,function(e){e.stopPropagation(),e.preventDefault()}),this.registEvent("dragenter",o.DragEnter,function(e){e.stopPropagation(),e.preventDefault()}),this.registEvent("dragexit",o.DragExit,function(e){e.stopPropagation(),e.preventDefault()}),this.registEvent("dragover",o.DragOver,function(e){e.stopPropagation(),e.preventDefault()})},e}(l);n.DragDropInput=y},{"../Numerics/Vector2":28,"./Exception":5}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e){this.processes=e.slice()}return e.prototype.clone=function(){return new e(this.processes)},e.prototype.extends=function(e){var t=this;return e.forEach(function(e){t.processes.indexOf(e)<0&&t.processes.push(e)}),this},e}();n.GeneralInterface=r},{}],9:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this)||this;return e.parent=null,e.children=[],e}return i(e,t),e.prototype.addChild=function(e){return(e.parent=this).children.push(e),this.joint(e),this},e.prototype.removeChild=function(e){var t=this.children.indexOf(e);return 0<=t&&(this.disjoint(e),e.parent=null,this.children.splice(t,1)),this},e}(e("./GeneralObject").GeneralObject);n.GeneralNode=o},{"./GeneralObject":10}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../Common/Identifier"),i=e("./GeneralProcess"),o=function(){function e(){this.identifier=r.Identifier.Unique,this.joints=[]}return e.prototype.joint=function(e){return i.GeneralProcess.setObjectSource(e,this),i.GeneralProcess.combine(this,e),this.joints.push(e),e.joints.push(this),this},e.prototype.disjoint=function(e){return this.joints.splice(this.joints.indexOf(e),1),e.joints.splice(e.joints.indexOf(this),1),i.GeneralProcess.seperate(this,e),i.GeneralProcess.setObjectSource(e,e),this},e.prototype.implements=function(e){var t=this;e.processes.forEach(function(e){t[e]||(t[e]=new i.GeneralProcess(t).next(t[e.slice(1)]))})},e}();n.GeneralObject=o},{"../Common/Identifier":6,"./GeneralProcess":11}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./GeneralTask"),i=function(){function a(e){this.thisArg=e,this.source=e,this.tasks=[]}return a.find=function(e){var t=[];for(var n in e){var r=e[n];r instanceof a&&t.push({key:n,value:r})}return t},a.setObjectSource=function(e,t){a.find(e).forEach(function(e){e.value.setSource(t)})},a.combine=function(e,t){a.every(e,t,function(e,r){e.next(function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r.process.apply(r,t)},t.identifier)})},a.seperate=function(e,t){a.every(e,t,function(e){e.remove(t.identifier)})},a.every=function(r,i,o){a.find(r).forEach(function(e){var t=r[e.key],n=i[e.key];n instanceof a&&o(t,n,e.key)})},a.prototype.setSource=function(e){this.source=e},a.prototype.process=function(){for(var t=this,n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];this.tasks.forEach(function(e){e.run.apply(e,[t.thisArg,t.source].concat(n))})},a.prototype.before=function(e,t){return e&&this.tasks.unshift(new r.GeneralTask(e,t)),this},a.prototype.next=function(e,t){return e&&this.tasks.push(new r.GeneralTask(e,t)),this},a.prototype.remove=function(t){var n=this;this.tasks.filter(function(e){return e.identifier===t}).forEach(function(e){var t=n.tasks.indexOf(e);n.tasks.splice(t,1)})},a.prototype.clear=function(){this.tasks=[]},a}();n.GeneralProcess=i},{"./GeneralTask":12}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t,n){void 0===t&&(t=Number.MIN_SAFE_INTEGER),void 0===n&&(n=!0),this.action=e,this.identifier=t,this.enabled=n}return e.prototype.run=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.enabled&&this.action&&(t=this.action).call.apply(t,[e].concat(n))},e}();n.GeneralTask=r},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function u(){}return u.clear=function(e){return e.clearRect(0,0,e.canvas.width,e.canvas.height),this},u.scaleOffset=function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=1);var i=e.canvas.width,o=e.canvas.height,a=i+t,s=o+n;return u.hold(e,function(){e.globalAlpha=r,e.translate(i/2,o/2),e.drawImage(e.canvas,-a/2,-s/2,a,s)}),this},u.rotate=function(e,t,n,r){void 0===n&&(n=1);var i=e.canvas.width,o=e.canvas.height,a=i/2,s=o/2;return u.hold(e,function(){e.translate(a,s),e.rotate(t),e.translate(-a,-s),e.globalAlpha=n,r&&r(e)}),this},u.mirror=function(e,t,n,r,i){void 0===r&&(r=1);var o=e.canvas.width,a=e.canvas.height,s=o/2,c=a/2;return u.hold(e,function(){e.translate(s,c),e.scale(t,n),e.translate(-s,-c),e.globalAlpha=r,i&&i(e)}),this},u.transform=function(e,t,n){return u.hold(e,function(){e.setTransform.apply(e,t.toArray()),n&&n(e)}),this},u.transparent=function(e,t,n){return void 0===t&&(t=1),u.hold(e,function(){e.globalAlpha=t,n&&n(e)}),this},u.hold=function(e,t){return e.save(),t&&t(e),e.restore(),this},u}();n.Graphics=r},{}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=e,this.canvas.height=t}return e.prototype.clear=function(){return this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this},e.prototype.draw=function(e){return e&&e(this.context),this},e.prototype.output=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.drawImage.apply(e,[this.canvas].concat(t)),this},e}();n.OffscreenCanvas=r},{}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../Common/DelayTimer"),i=function(){function e(){this.isLoop=!1,this.frameCount=0,this.framePerSecond=0,this.lastSecondCount=0,this.timer=new r.DelayTimer,this.onRateChanged=null}return e.prototype.loopInvoke=function(e){var t,n=this;this.isLoop=!0;var r=function(){e&&e(),n.frameCount+=1,n.timer.delay(1e3,function(e){var t=1e3===e?0:-1;n.framePerSecond=n.frameCount-n.lastSecondCount+t,n.lastSecondCount=n.frameCount,n.onRateChanged&&n.onRateChanged(n.framePerSecond)}),n.isLoop?t=window.requestAnimationFrame(r):(window.cancelAnimationFrame(t),n.frameCount=0,n.framePerSecond=0,n.lastSecondCount=0,n.stopCallback&&n.stopCallback())};r()},e.prototype.stop=function(e){this.stopCallback=e,this.isLoop=!1},e}();n.FrameManager=i},{"../../Common/DelayTimer":3}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./FrameManager"),i=function(){function e(e,t,n){this.container=e,this.canvas=t,this.context=t.getContext("2d"),this.world=n,this.world.initializeUI(e,t),this.frameManager=new r.FrameManager}return e.prototype.run=function(){var e=this;this.world.$start.process(),this.world.$gui.process(this.container),this.frameManager.loopInvoke(function(){e.world.$render.process(e.context),e.world.$update.process()})},e.prototype.stop=function(){var e=this;this.frameManager.stop(function(){e.context.clearRect(0,0,e.canvas.width,e.canvas.height)}),this.world.$dispose.process()},e}();n.GameBox=i},{"./FrameManager":15}],17:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../../Core/GeneralObject"),a=e("../../GameInterface/GameInterface"),s=e("../../../UI/Color"),c=function(i){function e(e,t,n){void 0===e&&(e=s.Colors.Black),void 0===t&&(t=10),void 0===n&&(n=!0);var r=i.call(this)||this;return r.fillColor=e,r.gradientNumber=t,r.direct=n,r.implements(a.GameEffectInterface),r}return o(e,i),e.prototype.start=function(e){var n=this;this.direct&&e.$render.before(function(e,t){return n.effect(t)},this.identifier)},e.prototype.update=function(){.5<Math.random()&&(this.fillColor=s.ColorHelper.gradientRandom(this.fillColor,this.gradientNumber))},e.prototype.effect=function(e){var t=e.canvas.width,n=e.canvas.height;e.fillStyle=this.fillColor.rgba,e.fillRect(0,0,t,n)},e}(i.GeneralObject);n.GhostEffect=c;var u=function(i){function e(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!0);var r=i.call(this)||this;return r.image=new Image,r.image.src=e,r.alpha=t,r.direct=n,r.implements(a.GameEffectInterface),r}return o(e,i),e.prototype.start=function(e){var n=this;this.direct&&e.$render.before(function(e,t){return n.effect(t)},this.identifier)},e.prototype.effect=function(e){var t=e.globalAlpha;e.globalAlpha=this.alpha,e.drawImage(this.image,0,0),e.globalAlpha=t},e}(i.GeneralObject);n.GhostImageEffect=u},{"../../../Core/GeneralObject":10,"../../../UI/Color":33,"../../GameInterface/GameInterface":18}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../Core/GeneralInterface");n.GameObjectInterface=new r.GeneralInterface(["$start","$dispose"]),n.GameViewInterface=n.GameObjectInterface.clone().extends(["$render"]),n.GameGUIInterface=n.GameObjectInterface.clone().extends(["$gui"]),n.GameEffectInterface=n.GameObjectInterface.clone().extends(["$update"]),n.GameVisualInterface=n.GameObjectInterface.clone().extends(["$update","$gui","$render"])},{"../../Core/GeneralInterface":8}],19:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../Core/GeneralObject"),a=e("../GameInterface/GameInterface"),s=function(t){function e(){var e=t.call(this)||this;return e.implements(a.GameViewInterface),e}return i(e,t),e}(o.GeneralObject);n.GameView=s},{"../../Core/GeneralObject":10,"../GameInterface/GameInterface":18}],20:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../Core/GeneralNode"),a=e("../GameInterface/GameInterface"),s=e("../../Common/Events"),c=function(t){function e(){var e=t.call(this)||this;return e.implements(a.GameVisualInterface),e.events=new s.Events,e}return i(e,t),e.prototype.on=function(e,t,n){void 0===n&&(n=!0),this.events.addHandler(e,t,n)},e.prototype.off=function(e,t){this.events.removeHandler(e,t)},e.prototype.dispatch=function(n){for(var e,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];(e=this.events).raiseEvent.apply(e,[n].concat(r)),this.children.forEach(function(e){var t;(t=e).dispatch.apply(t,[n].concat(r))})},e.prototype.dispose=function(){this.events.release()},e}(o.GeneralNode);n.GameVisual=c},{"../../Common/Events":4,"../../Core/GeneralNode":9,"../GameInterface/GameInterface":18}],21:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../GameObject/GameVisual"),a=e("../../Common/Inputs"),s=function(r){function e(e,t){var n=r.call(this)||this;return n.width=e,n.height=t,(n.world=n).inputs=(new a.Inputs).change(function(e,t){return n.dispatch(e,t)}),n.ui={container:null,canvas:null},n.initialize(),n.createObjects(),n}return i(e,r),Object.defineProperty(e.prototype,"size",{get:function(){return{width:this.width,height:this.height,center:{x:this.width/2,y:this.height/2}}},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){},e.prototype.createObjects=function(){},e.prototype.initializeUI=function(e,t){this.ui.container=e,this.ui.canvas=t,this.inputs.launch(this.ui.container)},e.prototype.addChild=function(e){return r.prototype.addChild.call(this,e),e.world=this},e.prototype.dispose=function(){r.prototype.dispose.call(this),this.inputs.release()},e}(o.GameVisual);n.GameWorld=s},{"../../Common/Inputs":7,"../GameObject/GameVisual":20}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(e){this.language=e}return Object.defineProperty(t,"LanguageSessionKey",{get:function(){return"General_SessionStorage_Language"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Netural",{get:function(){return new t(sessionStorage.getItem(t.LanguageSessionKey)||navigator.language||"en-US")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"en_US",{get:function(){return new t("en-US")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"zh_CN",{get:function(){return new t("zh-CN")},enumerable:!0,configurable:!0}),t.switch=function(e){sessionStorage.setItem(t.LanguageSessionKey,e)},Object.defineProperty(t.prototype,"displayName",{get:function(){return n.Languages[this.language]},enumerable:!0,configurable:!0}),t}();n.CultureInfo=r,n.Languages={"en-US":"English(United States)","zh-CN":"简体中文"}},{}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Common/Exception"),r=function(){function e(){}return e.openFileDialog=function(t,e){void 0===e&&(e="");var n=document.createElement("input");n.setAttribute("type","file"),n.setAttribute("accept",e),n.onchange=function(e){t&&t(e)},n.style.display="none",document.body.appendChild(n),n.click(),n.remove()},e.readAllText=function(e,t){this._readByFileReader(e,t,function(e,t){e.readAsText(t)})},e.readAsDataURL=function(e,t){this._readByFileReader(e,t,function(e,t){e.readAsDataURL(t)})},e._readByFileReader=function(e,t,n){var r=new FileReader;n(r,e),r.onload=function(){t&&t(r.result)},r.onerror=function(){throw new i.Exception("Could not read file, error code:"+r.error.code)}},e}();n.FileIO=r},{"../Common/Exception":5}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function n(){}return n.get=function(e,t){return n.request("GET",e,t)},n.request=function(e,t,n){var r=new XMLHttpRequest;r.open(e,t),r.send(),r.onload=function(){n&&n(r.response)}},n}();n.HttpWebRequest=r},{}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function s(e,t,n,r,i,o){return void 0===e&&(e=1),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===i&&(i=0),void 0===o&&(o=0),this.M11=e,this.M12=t,this.M21=n,this.M22=r,this.M31=i,this.M32=o,this}return Object.defineProperty(s,"Identity",{get:function(){return new s},enumerable:!0,configurable:!0}),s.createScale=function(e,t,n){var r=new s,i=n.x*(1-e),o=n.y*(1-t);return r.M11=e,r.M12=0,r.M21=0,r.M22=t,r.M31=i,r.M32=o,r},s.createRotation=function(e,t){var n=new s,r=Math.cos(e),i=Math.sin(e),o=t.x*(1-r)+t.y*i,a=t.y*(1-r)-t.x*i;return n.M11=r,n.M12=i,n.M21=-i,n.M22=r,n.M31=o,n.M32=a,n},s.createTranslation=function(e){var t=new s;return t.M11=1,t.M12=0,t.M21=0,t.M22=1,t.M31=e.x,t.M32=e.y,t},s.prototype.toArray=function(){return[this.M11,this.M12,this.M21,this.M22,this.M31,this.M32]},s.prototype.toIdentity=function(){return this.M11=this.M22=1,this.M12=this.M21=this.M31=this.M32=0,this},s.prototype.transform=function(e,t,n,r,i,o,a){var s=Math.cos(i),c=Math.sin(i);return this.append(s*n,c*n,-c*r,s*r,e,t),(o||a)&&(this.M31-=o*this.M11+a*this.M21,this.M32-=o*this.M12+a*this.M22),this},s.prototype.append=function(e,t,n,r,i,o){var a=this.M11,s=this.M12,c=this.M21,u=this.M22;return this.M11=e*a+t*c,this.M12=e*s+t*u,this.M21=n*a+r*c,this.M22=n*s+r*u,this.M31=i*a+o*c+this.M31,this.M32=i*s+o*u+this.M32,this},s.prototype.multiply=function(e){return this.append(e.M11,e.M12,e.M21,e.M22,e.M31,e.M32),this},s.prototype.invert=function(){var e=this.M11,t=this.M12,n=this.M21,r=this.M22,i=this.M31,o=e*r-t*n;return this.M11=r/o,this.M12=-t/o,this.M21=-n/o,this.M22=e/o,this.M31=(n*this.M32-r*i)/o,this.M32=-(e*this.M32-t*i)/o,this},s}();n.Matrix3x2=r},{}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.next=function(e){return void 0===e&&(e=Number.MAX_SAFE_INTEGER),Math.floor(0<=Math.random()*e?e:0)},e.prototype.range=function(e,t){return Math.ceil(e+Math.floor(Math.random()*(t-e)))},e.prototype.normal=function(e,t,n){void 0===n&&(n=3);for(var r=0,i=0;i<n;i++)r+=this.range(e,t+1);return r/n},e.prototype.sample=function(){return Math.random()},e}();n.Random=r},{}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Vector2"),i=e("./Matrix3x2"),o=function(){function e(){this.translation=new r.Vector2(0,0),this.scale=new r.Vector2(1,1),this.rotation=0,this.center=new r.Vector2(0,0)}return e.prototype.toMatrix3x2=function(){var e=i.Matrix3x2.createScale(this.scale.x,this.scale.y,this.center),t=i.Matrix3x2.createRotation(this.rotation,this.center),n=i.Matrix3x2.createTranslation(this.translation);return e.multiply(t).multiply(n)},e}();n.Transform=o},{"./Matrix3x2":25,"./Vector2":28}],28:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}return Object.defineProperty(r.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"sqrtLength",{get:function(){return this.x*this.x+this.y*this.y},enumerable:!0,configurable:!0}),r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.normalize=function(){var e=1/this.length;return new r(this.x*e,this.y*e)},r.prototype.negate=function(){return new r(-this.x,-this.y)},r.prototype.add=function(e){return new r(this.x+e.x,this.y+e.y)},r.prototype.subtract=function(e){return new r(this.x-e.x,this.y-e.y)},r.prototype.multiply=function(e){return new r(this.x*e,this.y*e)},r.prototype.divide=function(e){var t=1/e;return new r(this.x*t,this.y*t)},r.prototype.dot=function(e){return this.x*e.x+this.y*e.y},r.prototype.rotate=function(e){var t=Math.sin(e),n=Math.cos(e);return new r(this.x*n-this.y*t,this.y*n+this.x*t)},r.prototype.setLength=function(e){var t=this.length;0<t&&(this.x=this.x*e/t,this.y=this.y*e/t)},r.prototype.limitLength=function(e){e<this.length&&this.setLength(e)},r.prototype.cos=function(e){return this.dot(e)/(this.length*e.length)},r}();n.Vector2=r},{}],29:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return Object.defineProperty(e,"IsMobile",{get:function(){return/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)},enumerable:!0,configurable:!0}),e}();n.PlatformInfo=r},{}],30:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("./ResourceManager"),a=e("../Globalization/CultureInfo"),s=e("./ResourceSet"),c=function(n){function e(e){var t=n.call(this)||this;return t.config=e,t}return i(e,n),e.prototype.load=function(e){var t=this;return n.prototype.load.call(this,function(){t.target&&t.assign(t.target),e&&e()})},e.prototype.attach=function(e,t){return void 0===t&&(t=a.CultureInfo.Netural),this.add(new s.ResourceSet(this.config.get(t.language))),this.target=e,this},e.prototype.switch=function(e,t){return void 0===e&&(e=a.CultureInfo.Netural),this.sets=[],this.attach(this.target,e).load(t),this},e.prototype.assign=function(n){return this.sets.forEach(function(e){for(var t in n){void 0!==e.data[t]&&(n[t]=e.data[t])}}),this},e}(o.ResourceManager);n.CultureResourceManager=c;var u=function(){function e(e,t,n){void 0===n&&(n="{{language}}"),this.template=e,this.languages=t,this.replace=n}return e.prototype.get=function(t){return this.languages.findIndex(function(e){return e===t})<0&&(t=this.languages[0]),this.template.replace(this.replace,t)},e}();n.CultureResourceConfig=u},{"../Globalization/CultureInfo":22,"./ResourceManager":31,"./ResourceSet":32}],31:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("../Network/Network"),r=function(){function e(){this.sets=[]}return e.prototype.add=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.sets).push.apply(e,t)},e.prototype.load=function(n){var r=this.sets.length;return this.sets.forEach(function(t){i.HttpWebRequest.get(t.src,function(e){t.init(JSON.parse(e)),1,r&&n&&n()})}),this},e}();n.ResourceManager=r},{"../Network/Network":24}],32:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e){this.src=e}return e.prototype.init=function(e){this.data=e,this.loaded=!0},e}();n.ResourceSet=r},{}],33:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function n(e,t,n,r){void 0===e&&(e=255),void 0===t&&(t=255),void 0===n&&(n=255),void 0===r&&(r=1),this.r=e,this.g=t,this.b=n,this.a=r}return n.fromHex=function(e){var t=parseInt(e.slice(1),16);return new n(t/65536,t/256%256,t%256)},n.fromNumber=function(e){return new n(e/65536,e/256%256,e%256)},Object.defineProperty(n.prototype,"hex",{get:function(){var e=Math.floor(this.r),t=Math.floor(this.g),n=Math.floor(this.b),r=e<16?"0":"",i=n<16?"0":"";return"#"+(t<16?"0":"")+e.toString(16)+r+t.toString(16)+i+n.toString(16)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rgb",{get:function(){return"rgb("+Math.floor(this.r)+","+Math.floor(this.g)+","+Math.floor(this.b)+")"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rgba",{get:function(){return"rgba("+Math.floor(this.r)+","+Math.floor(this.g)+","+Math.floor(this.b)+","+this.a+")"},enumerable:!0,configurable:!0}),n.prototype.clone=function(){return new n(this.r,this.g,this.b,this.a)},n}();n.Color=a;var r=function(){function e(){}return e.gradient=function(e,t){void 0===t&&(t=1);var n=e.r;n+=t,n=Math.min(255,Math.max(0,n));var r=e.g;r+=t,r=Math.min(255,Math.max(0,r));var i=e.b;return i+=t,i=Math.min(255,Math.max(0,i)),new a(n,r,i,e.a)},e.gradientRandom=function(e,t){void 0===t&&(t=1);var n=t/2,r=e.r;r+=Math.random()*t-n,r=Math.min(255,Math.max(0,r));var i=e.g;i+=Math.random()*t-n,i=Math.min(255,Math.max(0,i));var o=e.b;return o+=Math.random()*t-n,o=Math.min(255,Math.max(0,o)),new a(r,i,o,e.a)},e}();n.ColorHelper=r;var i=function(){function e(){}return Object.defineProperty(e,"Black",{get:function(){return new a(0,0,0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"White",{get:function(){return new a(255,255,255,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Gray",{get:function(){return new a(128,128,128,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Random",{get:function(){return new a(255*Math.random(),255*Math.random(),255*Math.random(),1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RandomGray",{get:function(){var e=255*Math.random();return new a(e,e,e,1)},enumerable:!0,configurable:!0}),e}();n.Colors=i},{}],34:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../Numerics/Vector2"),i=function(){function e(){}return e.getEventClientPositon=function(e){return e instanceof MouseEvent?new r.Vector2(e.clientX,e.clientY):e instanceof TouchEvent?new r.Vector2(e.changedTouches[0].clientX,e.changedTouches[0].clientY):null},e}();n.EventHelper=i},{"../Numerics/Vector2":28}],35:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GalleryStarter=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("./Visuals/ParticlesFlyerWorld"),o=e("./Visuals/ParticlesWalkerWorld"),a=e("./Visuals/ParticlesTreeWorld"),s=e("./Visuals/LSystemTreeWorld"),c=e("./Visuals/GameOfLifeWorld"),u=e("./Visuals/AudioVisualizerWorld"),l=e("./Games/EndlessAbyssWorld"),f=e("../Engine/Game/GameBox/GameBox");var h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.symbols={},this.addSymbol("flyer",i.ParticlesFlyerWorld),this.addSymbol("walker",o.ParticlesWalkerWorld),this.addSymbol("tree",a.ParticlesTreeWorld),this.addSymbol("lsystemtree",s.LSystemTreeWorld),this.addSymbol("gameoflife",c.GameOfLifeWorld),this.addSymbol("audiovisualizer",u.AudioVisualizerWorld),this.addSymbol("endlessabyss",l.EndlessAbyssWorld)}return r(e,[{key:"addSymbol",value:function(e,t){this.symbols[e]=t}},{key:"getSymbolByName",value:function(e){return this.symbols[e]}},{key:"launch",value:function(e,t){var n=this._getRequest(),r=this.getSymbolByName(n.scene);if(r)return document.title=r.Title,new f.GameBox(e,t,new r(t.width,t.height));window.location="../"}},{key:"_getRequest",value:function(){var e={},t=location.search;if(0<=t.indexOf("?"))for(var n=t.substr(1).split("&"),r=0;r<n.length;r++)e[n[r].split("=")[0]]=unescape(n[r].split("=")[1]);return e}}]),e}();n.GalleryStarter=h},{"../Engine/Game/GameBox/GameBox":16,"./Games/EndlessAbyssWorld":41,"./Visuals/AudioVisualizerWorld":44,"./Visuals/GameOfLifeWorld":48,"./Visuals/LSystemTreeWorld":54,"./Visuals/ParticlesFlyerWorld":65,"./Visuals/ParticlesTreeWorld":66,"./Visuals/ParticlesWalkerWorld":67}],36:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.EndlessAbyssView=n.EndlessAbyss=void 0;var i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),r=e("../../../Engine/Game/GameObject/GameVisual"),o=e("../../../Engine/Numerics/Vector2"),a=e("../../../Engine/UI/Color"),s=e("../../../Engine/Utilities/EventHelper"),c=e("../../../Engine/Game/GameObject/GameView"),u=e("./Models/BlockGrid"),l=e("../../../Engine/Game/GameComponents/Effect/Effect"),f=e("../../../Engine/Common/DelayTimer"),h=e("../../../Engine/Drawing/Graphics"),p=e("../../../Engine/Drawing/OffscreenCanvas"),d=e("../../../Engine/Common/Inputs"),y=e("../../Resources/GalleryResource");function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var b=function(e){function t(){v(this,t);var e=g(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.timer=new f.DelayTimer,e.ghost=new l.GhostEffect(new a.Color(0,0,0,.01),40,!1),e.joint(e.ghost),e}return m(t,r.GameVisual),i(t,[{key:"start",value:function(){var e=this.world.width,t=this.world.height;this.settings={width:10,rotation:0,center:new o.Vector2(e/2,t/2),playing:!1,gameover:!1,score:0,progress:0,delayTime:500,pointer:{position:new o.Vector2,rotation:0,count:0}},this.blockGrid=new u.BlockGrid(this.settings.width,20),this._registEvents()}},{key:"update",value:function(){var t=this;this.settings.playing&&this.timer.delay(this.settings.delayTime,function(){t.blockGrid.down(),t.settings.progress=0},function(e){t.settings.progress=e/t.settings.delayTime}),this.settings.rotation+=.002}},{key:"_registEvents",value:function(){var o=this;this.on(d.InputEvents.KeyPress,function(e){o.settings.playing?"a"===e.key?o.blockGrid.left():"d"===e.key?o.blockGrid.right():"w"===e.key?o.blockGrid.up():"s"===e.key&&o.blockGrid.down():"Enter"===e.key&&(o.settings.playing=!0,o.settings.gameover&&(o.settings.gameover=!1,o.blockGrid.reset()))}),this.on(d.InputEvents.PointerPressed,function(e){var t=o.settings.pointer;t.position=s.EventHelper.getEventClientPositon(e),t.rotation=o.settings.rotation,t.count=0}),this.on(d.InputEvents.PointerMoved,function(e){if(o.world.inputs.pointer.isPressed){var t=o.settings.pointer,n=s.EventHelper.getEventClientPositon(e).subtract(t.position),r=t.position.subtract(o.settings.center).rotate(Math.PI/2).normalize(),i=n.dot(r)/100;o.settings.rotation=t.rotation+i,t.count+=1,8<t.count&&(t.position=s.EventHelper.getEventClientPositon(e),t.rotation=o.settings.rotation,t.count=0)}}),this.blockGrid.onOver=function(){o.settings.playing=!1,o.settings.gameover=!0,o.settings.score=0},this.blockGrid.onFullRow=function(e){o.settings.score+=10*Math.pow(2,e-1)}}}]),t}(),w=function(e){function r(){v(this,r);var e=g(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));e.fill={white:new a.Color(255,255,255,.05),blank:new a.Color(255,255,255,.05),mask:new a.Color(0,0,0,.6)},e.stroke={white:new a.Color(255,255,255,.05),black:new a.Color(0,0,0,.2)};var t=e.stroke.white,n=e.fill.white;return e.styles=[[t,null,!1,!1],[t,n,!1,!0],[null,e.fill.blank,!1,!1],[null,null,!0,!0],[e.stroke.black,null,!1,!1],[t,null,!1,!0]],e.joint(new _),e.joint(new O),e}return m(r,c.GameView),i(r,[{key:"render",value:function(e){this.target=e}},{key:"drawAll",value:function(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],r=this.target.blockGrid.width,i=this.target.blockGrid.height,o=(.8*Math.min(t.width,t.height)-100)/i/2+0,a=1-this.target.settings.progress,s=this.target.blockGrid.allBlocks,c=this.target.blockGrid.preBlocks,u=this.target.blockGrid,l=this.target.blockGrid.current.getBlocks(),f=this.target.blockGrid.next.getBlocks(),h={center:t.center,radius:50,blockHeight:o,blockBorder:0,yOffset:0,split:r};n?(this.drawBlocks(e,s,h,this.styles[0]),this.drawBlocks(e,u,h,this.styles[1]),this.drawBlocks(e,c,h,this.styles[2]),h.yOffset=4,this.drawBlocks(e,f,h,this.styles[3])):(this.drawBlocks(e,u,h,this.styles[4]),h.yOffset=a,this.drawBlocks(e,l,h,this.styles[5])),h.yOffset=0}},{key:"drawBlocks",value:function(u,e,l,f){var h=this,p=Math.PI/l.split,d=l.blockHeight-l.blockBorder;e.forEach(function(e){if(e){var t=e.location.x,n=e.location.y+l.yOffset,r=t*p*2,i=r-p+h.target.settings.rotation,o=r+p+h.target.settings.rotation,a=f[2]?e.color:f[0],s=f[3]?e.color:f[1],c={center:l.center,radius:l.radius+n*l.blockHeight,height:d,start:i,end:o};h.drawSingle(u,c,a,s)}})}},{key:"drawSingle",value:function(e,t,n,r){e.beginPath(),e.arc(t.center.x,t.center.y,t.radius,t.start,t.end,!1),e.arc(t.center.x,t.center.y,t.radius+t.height,t.end,t.start,!0),e.closePath(),n&&(e.strokeStyle=n.rgba,e.stroke()),r&&(e.fillStyle=r.rgba,e.fill())}}]),r}(),_=function(e){function t(){return v(this,t),g(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return m(t,c.GameView),i(t,[{key:"render",value:function(t,e){var n=this;this.innerCanvas||(this.innerCanvas=new p.OffscreenCanvas(e.canvas.width,e.canvas.height));var r=t.target.world.size;this.innerCanvas.draw(function(e){n.drawDynamic(t,e,r)}).output(e,0,0)}},{key:"drawDynamic",value:function(e,t,n){e.target.ghost.effect(t),h.Graphics.scaleOffset(t,8,8*t.canvas.height/t.canvas.width,.99),e.drawAll(t,n)}}]),t}(),O=function(e){function t(){v(this,t);var e=g(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.single=0,e.fill={mask:new a.Color(0,0,0,.6)},e}return m(t,c.GameView),i(t,[{key:"render",value:function(e,t){var n=e.target.world.size;this.drawStatic(e,t,n)}},{key:"drawStatic",value:function(e,t,n){e.target.settings.playing?(e.drawAll(t,n,!1),this.drawScore(t,n,e.target.settings.score)):(this.drawMask(t,n),e.target.settings.gameover?this.drawTitle(t,n,y.GalleryResources.EndlessAbyssWorld.GameOver):this.drawTitle(t,n,y.GalleryResources.EndlessAbyssWorld.GameName),this.drawNotify(t,n))}},{key:"drawMask",value:function(e,t){e.fillStyle=this.fill.mask.rgba,e.fillRect(0,0,t.width,t.height)}},{key:"drawTitle",value:function(e,t,n){var r=Math.max(t.width/20,48);e.font=r+"px Arial",e.textAlign="center",e.fillStyle="#FFF",e.fillText(n,t.center.x,t.center.y)}},{key:"drawNotify",value:function(e,t){var n=Math.max(t.width/64,16);e.font=n+"px Arial",e.textAlign="center",this.single+=.06,e.fillStyle=new a.Color(255,255,255,.6+.3*Math.sin(this.single)).rgba,e.fillText(y.GalleryResources.EndlessAbyssWorld.Tip,t.center.x,t.center.y+1.6*n)}},{key:"drawScore",value:function(e,t,n){var r=Math.max(t.width/48,24);e.font=r+"px Arial",e.textAlign="right",e.fillStyle=new a.Color(255,255,255,.9).rgba,e.fillText(y.GalleryResources.EndlessAbyssWorld.Score+n,.9*t.width,.15*t.height)}}]),t}();n.EndlessAbyss=b,n.EndlessAbyssView=w},{"../../../Engine/Common/DelayTimer":3,"../../../Engine/Common/Inputs":7,"../../../Engine/Drawing/Graphics":13,"../../../Engine/Drawing/OffscreenCanvas":14,"../../../Engine/Game/GameComponents/Effect/Effect":17,"../../../Engine/Game/GameObject/GameView":19,"../../../Engine/Game/GameObject/GameVisual":20,"../../../Engine/Numerics/Vector2":28,"../../../Engine/UI/Color":33,"../../../Engine/Utilities/EventHelper":34,"../../Resources/GalleryResource":42,"./Models/BlockGrid":38}],37:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Block=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../../../Engine/Numerics/Vector2"),o=e("../../../../../Engine/UI/Color");var a=function(){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.location=new i.Vector2(e,t),this.color=o.Colors.White}return r(n,[{key:"setLocation",value:function(e){return this.location=e,this}},{key:"setColor",value:function(e){return this.color=e,this}}]),n}();n.Block=a},{"../../../../../Engine/Numerics/Vector2":28,"../../../../../Engine/UI/Color":33}],38:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BlockGrid=void 0;var i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("../../../../Engine/Collections/Array2"),s=e("../../../../Engine/Numerics/Vector2"),a=e("../../../../Engine/UI/Color"),c=e("./BlockGroup"),u=e("./Block/Block");var r=function(e){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t));n.current=null,n.next=null,n.upOffset=new s.Vector2(0,0),n.downOffset=new s.Vector2(0,-1),n.leftOffset=new s.Vector2(-1,0),n.rightOffset=new s.Vector2(1,0),n.indexOffset=1;return n.colors=["#8F1D78","#BA874C","#E9AE6A"].map(function(e){return a.Color.fromHex(e)}),n.blockGroups=c.BlockGroupHelper.getStandardGroups(),n._generateNext(),n._generateCurrent(),n.onOver=null,n.onFullRow=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,o.Array2),i(r,[{key:"allBlocks",get:function(){return this._allBlocks}},{key:"preBlocks",get:function(){return this._preBlocks}}]),i(r,[{key:"up",value:function(){this._checkMoveAvaliable(this.current,this.upOffset,this.indexOffset)&&this.current.move(this.upOffset).rotate(this.indexOffset)}},{key:"down",value:function(){this._checkMoveAvaliable(this.current,this.downOffset)?this.current.move(this.downOffset):this.current.location.y===this.height-1?this.over():(this._combineBlock(this.current),this._generateCurrent())}},{key:"left",value:function(){this._checkMoveAvaliable(this.current,this.leftOffset)&&this.current.move(this.leftOffset)}},{key:"right",value:function(){this._checkMoveAvaliable(this.current,this.rightOffset)&&this.current.move(this.rightOffset)}},{key:"reset",value:function(){var r=this;this.forEach(function(e,t,n){r.set(t,n,null)})}},{key:"over",value:function(){this.onOver&&this.onOver()}},{key:"setCurrent",value:function(e){this.current=e}},{key:"_generateCurrent",value:function(){this.current=this.next,this._generateNext(),this._generateInformation()}},{key:"_generateNext",value:function(){var e=Math.floor(Math.random()*this.blockGroups.length),t=new s.Vector2(Math.floor(this.width*Math.random()),this.height-1),n=Math.floor(4*Math.random()),r=this.colors[Math.floor(this.colors.length*Math.random())];this.next=this.blockGroups[e].clone().setLocation(t).setColor(r).rotate(n)}},{key:"_generateInformation",value:function(){var r=this;this._allBlocks=[],this._preBlocks=[];var i=this._findMaxRow();this.forEach(function(e,t,n){r._allBlocks.push(e||new u.Block(t,n)),!e&&n<=i&&r._preBlocks.push(new u.Block(t,n))})}},{key:"_checkMoveAvaliable",value:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:s.Vector2.Zero(),n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],i=this.current.getLocations(n),o=0;o<i.length;o++){var a=i[o].add(t);if(r&&(a.x=a.x%this.width,a.x<0&&(a.x+=this.width)),a.y<0||this.get(a.x,a.y))return!1}return!0}},{key:"_combineBlock",value:function(e){var t=this,n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];e.getBlocks().forEach(function(e){e&&(n&&(e.location.x=e.location.x%t.width,e.location.x<0&&(e.location.x+=t.width)),t.set(e.location.x,e.location.y,e))}),this._combineFullRow()}},{key:"_combineFullRow",value:function(){for(var e=0,t=this._findMaxRow();0<=t;t--)this._checkFullRow(t)&&(this._clearSingleRow(t),e+=1);0<e&&(this.onFullRow&&this.onFullRow(e),this._updateBlockLocation())}},{key:"_findMaxRow",value:function(){for(var e=-1,t=0;t<this.height;t++)for(var n=0;n<this.width;n++)if(this.get(n,t)){e=t;break}return e}},{key:"_clearSingleRow",value:function(e){for(var t=0;t<this.width;t++)this.data[t].splice(e,1),this.data[t].push(null)}},{key:"_checkFullRow",value:function(e){for(var t=0;t<this.width;t++)if(!this.get(t,e))return!1;return!0}},{key:"_updateBlockLocation",value:function(){this.forEach(function(e,t,n){e&&e.setLocation(new s.Vector2(t,n))})}}]),r}();n.BlockGrid=r},{"../../../../Engine/Collections/Array2":2,"../../../../Engine/Numerics/Vector2":28,"../../../../Engine/UI/Color":33,"./Block/Block":37,"./BlockGroup":39}],39:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BlockGroupHelper=n.BlockGroup=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("./OffsetMap/OffsetMap"),o=e("./Block/Block"),a=e("../../../../Engine/Numerics/Vector2"),s=e("../../../../Engine/UI/Color");function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=function(){function t(){c(this,t),this.location=new a.Vector2(0,0),this.color=s.Colors.White,this.offsetMaps=[],this.currentIndex=0}return r(t,[{key:"clone",value:function(){var e=new t;return e.location=this.location.clone(),e.color=this.color,e.offsetMaps=this.offsetMaps,e.currentIndex=this.currentIndex,e}},{key:"setLocation",value:function(e){return this.location=e,this}},{key:"setColor",value:function(e){return this.color=e,this}},{key:"addOffsetMap",value:function(e){return this.offsetMaps.push(e),this}},{key:"addOffsetMapRange",value:function(e){var t=this;return e.forEach(function(e){t.offsetMaps.push(e)}),this}},{key:"getLocations",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=(this.currentIndex+e)%this.offsetMaps.length;return this.offsetMaps[t].getLocations(this.location)}},{key:"getBlocks",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=[];return this.getLocations(e).forEach(function(e){n.push((new o.Block).setLocation(e).setColor(t.color.clone()))}),n}},{key:"move",value:function(e){return this.location=this.location.add(e),this}},{key:"rotate",value:function(){return this.currentIndex=(this.currentIndex+1)%this.offsetMaps.length,this}}]),t}(),l=function(){function e(){c(this,e)}return r(e,null,[{key:"getStandardGroups",value:function(){return[[{x:[0,0,0,0],y:[0,-1,-2,-3]},{x:[0,1,2,3],y:[0,0,0,0]}],[{x:[1,1,1,0],y:[0,-1,-2,-2]},{x:[0,0,1,2],y:[,-1,-1,-1]},{x:[0,1,0,0],y:[0,0,-1,-2]},{x:[0,1,2,2],y:[0,0,0,-1]}],[{x:[0,0,0,1],y:[0,-1,-2,-2]},{x:[0,1,2,0],y:[0,0,0,-1]},{x:[0,1,1,1],y:[0,0,-1,-2]},{x:[2,0,1,2],y:[0,-1,-1,-1]}],[{x:[0,1,0,1],y:[0,0,-1,-1]}],[{x:[1,2,0,1],y:[0,0,-1,-1]},{x:[0,0,1,1],y:[0,-1,-1,-2]}],[{x:[0,1,1,2],y:[0,0,-1,-1]},{x:[1,1,0,0],y:[0,-1,-1,-2]}],[{x:[0,1,2,1],y:[0,0,0,-1]},{x:[1,0,1,1],y:[0,-1,-1,-2]},{x:[1,0,1,2],y:[0,-1,-1,-1]},{x:[0,0,1,0],y:[0,-1,-1,-2]}]].map(function(e){return(new u).addOffsetMapRange(e.map(function(n){return new i.OffsetMap(n.x.map(function(e,t){return new a.Vector2(n.x[t],n.y[t])}))}))})}}]),e}();n.BlockGroup=u,n.BlockGroupHelper=l},{"../../../../Engine/Numerics/Vector2":28,"../../../../Engine/UI/Color":33,"./Block/Block":37,"./OffsetMap/OffsetMap":40}],40:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var i=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.offsets=e}return r(t,[{key:"setOffsets",value:function(e){return this.offsets=e,this}},{key:"getLocations",value:function(t){var n=[];return this.offsets.forEach(function(e){n.push(t.add(e))}),n}}]),t}();n.OffsetMap=i},{}],41:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.EndlessAbyssWorld=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Game/GameWorld/GameWorld"),o=e("../../Engine/Common/Inputs"),a=e("./EndlessAbyss/EndlessAbyss"),s=e("../Visuals/VisualPointer/VisualPointer"),c=e("../Resources/GalleryResource");var u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GameWorld),r(t,[{key:"initialize",value:function(){this.inputs.addInput(new o.PointerInput),this.inputs.addInput(new o.KeyInput)}},{key:"createObjects",value:function(){this.addChild((new a.EndlessAbyss).joint(new a.EndlessAbyssView)),this.joint(new s.VisualPointer)}}],[{key:"Title",get:function(){return c.GalleryResources.EndlessAbyssWorld.Title}}]),t}();n.EndlessAbyssWorld=u},{"../../Engine/Common/Inputs":7,"../../Engine/Game/GameWorld/GameWorld":21,"../Resources/GalleryResource":42,"../Visuals/VisualPointer/VisualPointer":68,"./EndlessAbyss/EndlessAbyss":36}],42:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GalleryResources=n.GalleryResourceManager=void 0;var r=e("../../Engine/Resources/CultureResourceManager"),i={Gallery:"",AudioVisualizerWorld_Title:"",GameOfLifeWorld_Title:"",LSystemTreeWorld_Title:"",ParticlesFlyerWorld_Title:"",ParticlesTreeWorld_Title:"",PartilesWalkerWorld_Title:"",EndlessAbyssWorld:{Title:"",GameName:"",GameOver:"",Tip:"",Score:""},Warnings:{OpenOnPC:{Title:"",Content:""}},Tooltips:{Restart:"",Fullscreen:""}},o=new r.CultureResourceConfig("../static/i18n/gallery.{{language}}.json",["en-US","zh-CN"]),a=new r.CultureResourceManager(o).attach(i);n.GalleryResourceManager=a,n.GalleryResources=i},{"../../Engine/Resources/CultureResourceManager":30}],43:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AudioVisualizerView=n.AudioVisualizer=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../Engine/Game/GameObject/GameVisual"),o=e("../../../Engine/Common/DelayTimer"),a=e("../../../Engine/IO/FileIO"),s=e("../../../Engine/Game/GameComponents/Effect/Effect"),c=e("../../../Engine/UI/Color"),u=e("../../../Engine/Application/MessageBox"),l=e("../../../Engine/Game/GameObject/GameView"),f=e("../../../Engine/Drawing/Graphics"),h=e("../../../Engine/Drawing/OffscreenCanvas"),p=e("../../../Engine/Common/Inputs");function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=function(e){function t(){d(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.timer=new o.DelayTimer,e.effects={ghost:new s.GhostEffect(new c.Color(0,0,0,.01),40,!1)},e.joint(e.effects.ghost),e}return v(t,i.GameVisual),r(t,[{key:"FFTData",get:function(){return this.audioAnalyzer.getByteFrequencyData(this.freqByteData),this.freqByteData}}]),r(t,[{key:"start",value:function(){var t=this;this.initAudio(),this.on(p.InputEvents.Drop,function(e){t.loadFile(e.dataTransfer.files[0])}),this.on(p.InputEvents.PointerClicked,function(){a.FileIO.openFileDialog(function(e){t.loadFile(e.target.files[0])},"audio/*")})}},{key:"dispose",value:function(){(function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this),this.audioContext.close(),this.audio&&this.audio.remove()}},{key:"initAudio",value:function(){this.audioContext=new AudioContext,this.audio=document.createElement("audio"),this.audio.loop=!0,document.body.appendChild(this.audio),this.audioSource=this.audioContext.createMediaElementSource(this.audio),this.audioAnalyzer=this.audioContext.createAnalyser(),this.fftSize=1200<this.world.width?2048:1024,this.audioAnalyzer.fftSize=this.fftSize,this.freqByteData=new Uint8Array(this.audioAnalyzer.frequencyBinCount),this.audioSource.connect(this.audioAnalyzer),this.audioAnalyzer.connect(this.audioContext.destination),this.file={name:"",playing:!1}}},{key:"loadFile",value:function(e){e&&0===e.type.indexOf("audio")?(this.audio.src=URL.createObjectURL(e),this.audio.autoplay=!0,this.audio.play(),this.file.playing=!0,this.file.name=e.name.split(".").shift()):u.MessageBox.show("Please select a valid audio file.")}}]),t}(),m=function(e){function t(){d(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.rotation=0,e.rotation2=0,e}return v(t,l.GameView),r(t,[{key:"render",value:function(t,e){var n=this;this.innerCanvas||(this.innerCanvas=new h.OffscreenCanvas(e.canvas.width,e.canvas.height)),this.innerCanvas.draw(function(e){n.drawDynamic(t,e)}).output(e,0,0),this.drawStatic(t,e)}},{key:"drawDynamic",value:function(e,t){var n=this,r=e.world.width,i=e.world.height,o=r/2,a=i/2;e.effects.ghost.effect(t),e.file.playing?(this.rotation+=.001,f.Graphics.scaleOffset(t,5,5,.99),f.Graphics.rotate(t,this.rotation,1,function(){n.drawFFT(e,t,r,i,o,a)}),f.Graphics.rotate(t,Math.PI,1,function(){t.drawImage(t.canvas,0,0,r,i)})):(this.drawText(e,t,r,i,o,a),f.Graphics.mirror(t,1,-1,.01,function(){t.drawImage(t.canvas,0,0)}))}},{key:"drawText",value:function(e,t,n,r,i,o){var a=Math.max(n/30,32);t.font=a+"px Arial",t.textAlign="center",t.fillStyle="#FFF",t.fillText("Drag an audio file here.",i,o-a/2.5),t.fillRect(0,o-2,n,4)}},{key:"drawFFT",value:function(e,t,n,r,i,o){var a=e.FFTData;t.beginPath(),this.rotation2+=.002;for(var s=0;s<a.length;s++){var c=a[s],u=s/a.length*n,l=o+c+100*Math.sin(u/(100+50*Math.sin(this.rotation2)));t.lineTo(u,l)}t.lineWidth=n/a.length,t.strokeStyle="#FFF",t.stroke()}},{key:"drawStatic",value:function(e,t){var n=e.world.width,r=e.world.height;this.drawFileinfo(e,t,n,r)}},{key:"drawFileinfo",value:function(e,t,n,r){var i=e.file;if(i.playing){var o=Math.max(n/48,16),a=.1*n,s=.8*r;t.font=o+"px Arial",t.textAlign="left",t.fillStyle="#FFF",t.fillText(i.name,a,s);var c=.8*n,u=e.audio.currentTime/e.audio.duration;t.strokeStyle="#FFF",t.strokeRect(a,s+o,c,o/3),t.fillRect(a,s+o,c*u,o/3)}}}]),t}();n.AudioVisualizer=g,n.AudioVisualizerView=m},{"../../../Engine/Application/MessageBox":1,"../../../Engine/Common/DelayTimer":3,"../../../Engine/Common/Inputs":7,"../../../Engine/Drawing/Graphics":13,"../../../Engine/Drawing/OffscreenCanvas":14,"../../../Engine/Game/GameComponents/Effect/Effect":17,"../../../Engine/Game/GameObject/GameView":19,"../../../Engine/Game/GameObject/GameVisual":20,"../../../Engine/IO/FileIO":23,"../../../Engine/UI/Color":33}],44:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AudioVisualizerWorld=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Game/GameWorld/GameWorld"),o=e("../../Engine/Common/Inputs"),a=e("./AudioVisualizer/AudioVisualizer"),s=e("../Resources/GalleryResource");var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GameWorld),r(t,[{key:"initialize",value:function(){this.inputs.addInput(new o.PointerInput),this.inputs.addInput(new o.DragDropInput)}},{key:"createObjects",value:function(){this.addChild((new a.AudioVisualizer).joint(new a.AudioVisualizerView))}}],[{key:"Title",get:function(){return s.GalleryResources.AudioVisualizerWorld_Title}}]),t}();n.AudioVisualizerWorld=c},{"../../Engine/Common/Inputs":7,"../../Engine/Game/GameWorld/GameWorld":21,"../Resources/GalleryResource":42,"./AudioVisualizer/AudioVisualizer":43}],45:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;i(this,n),this.color=e,this.scale=t}return r(n,[{key:"setColor",value:function(e){return this.color=e,this}}]),n}();n.Cell=o,n.ScaleCell=function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;i(this,e),this.scale=t}},{}],46:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CellularAutomata=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),f=e("../../../Engine/UI/Color"),i=e("../../../Engine/Collections/Array2");var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Array2),r(t,[{key:"generate",value:function(){return new t(this.width,this.height)}},{key:"around",value:function(e,t,n,r){for(var i=0,o=0;o<8;o++){var a=e+n[o],s=t+r[o];this.data[a]&&this.data[a][s]&&(i+=1)}return i}},{key:"aroundColor",value:function(e,t,n,r){for(var i=0,o=0,a=0,s=0,c=0;c<8;c++){var u=e+n[c],l=t+r[c];this.data[u]&&this.data[u][l]&&(i+=this.data[u][l].color.r,o+=this.data[u][l].color.g,a+=this.data[u][l].color.b,s+=1)}return new f.Color(i/s,o/s,a/s)}},{key:"grow",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.001;this.forEach(function(e){e&&e.scale<1&&(e.scale+=t)})}}]),t}();n.CellularAutomata=o},{"../../../Engine/Collections/Array2":2,"../../../Engine/UI/Color":33}],47:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GameOfLifeView=n.GameOfLife=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../../Engine/Game/GameObject/GameVisual"),o=e("../../../../Engine/Game/GameComponents/Effect/Effect"),l=e("../../../../Engine/UI/Color"),a=e("../CellularAutomata"),f=e("../../../../Engine/Numerics/Vector2"),s=e("../Cell"),c=e("../../../../Engine/Game/GameObject/GameView"),h=e("../../../../Engine/Drawing/Graphics"),u=e("../../../../Engine/Common/DelayTimer"),p=e("../../../../Engine/Common/Inputs");function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=function(e){function t(){d(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.ghost=new o.GhostEffect(new l.Color(0,0,0,.08),0),e.joint(e.ghost),e.timers={generate:new u.DelayTimer,exchange:new u.DelayTimer,grow:new u.DelayTimer},e.settings={xOffsets:[-1,0,1,1,1,0,-1,-1],yOffsets:[-1,-1,-1,0,1,1,1,0],progress:0,sin:Math.PI,size:0,initialSize:16,rangeSize:16,rotation:0},e}return v(t,i.GameVisual),r(t,[{key:"offset",get:function(){var e=this.settings.size,t=this.settings.initialSize,n=-(e-t)*this.CA.width/2,r=-(e-t)*this.CA.height/2;return new f.Vector2(n,r)}}]),r(t,[{key:"start",value:function(){var r=this,e=this.world.width,t=this.world.height;this.settings.rangeSize=Math.min(e,t)/16,this.settings.initialSize=Math.min(e,t)/60;var n=Math.round(e/this.settings.initialSize),i=Math.round(t/this.settings.initialSize);this.CA=new a.CellularAutomata(n,i),this.CA.forEach(function(e,t,n){.9<Math.random()&&(r.CA.data[t][n]=new s.ScaleCell)}),this._bindEvents()}},{key:"update",value:function(){var t=this;this.timers.exchange.delay(1e3,function(){t.settings.progress=0,t._exchange(t.CA)},function(e){t.settings.progress=e/1e3}),this.timers.generate.delay(1e3,function(){t._generate()}),this.timers.grow.delay(100,function(){t.CA.grow(.005)}),this.settings.rotation+=1e-4,this.settings.sin+=5e-4,this.settings.size=this.settings.initialSize+Math.sin(this.settings.sin)*this.settings.rangeSize+this.settings.rangeSize}},{key:"_bindEvents",value:function(){var e=this;this.on(p.InputEvents.PointerMoved,function(){e._delete()}),this.on(p.InputEvents.PointerPressed,function(){e._delete()})}},{key:"_delete",value:function(){if(this.world.inputs.pointer.isPressed)for(var e=new f.Vector2(this.world.width/2,this.world.height/2),t=this.world.inputs.pointer.position,n=e.add(t.subtract(e).rotate(-this.settings.rotation)).subtract(this.offset),r=Math.round(n.x/this.settings.size),i=Math.round(n.y/this.settings.size),o=0;o<4;o++){var a=r+Math.round(2*Math.random()-1),s=i+Math.round(2*Math.random()-1);this.CA.data[a][s]=null}}},{key:"_generate",value:function(){var i=this,o=this.CA.generate();this.CA.forEach(function(e,t,n){var r=i.CA.around(t,n,i.settings.xOffsets,i.settings.yOffsets);e?2!==r&&3!==r&&4!==r||(o.data[t][n]=i.CA.data[t][n]):3===r&&(o.data[t][n]=new s.ScaleCell)}),this.CA=o}},{key:"_exchange",value:function(e){var t=e.data.splice(0,1);e.data.push(t[0])}}]),t}(),m=function(e){function t(){return d(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return v(t,c.GameView),r(t,[{key:"render",value:function(e,a){var s=e.offset,c=e.settings.size,u=1-e.settings.progress;h.Graphics.scaleOffset(a,-4,-4,1),h.Graphics.rotate(a,e.settings.rotation,1,function(){a.beginPath(),e.CA.forEach(function(e,t,n){if(e){var r=new f.Vector2((t+u)*c,n*c).add(s),i=c*e.scale,o=i/2;a.rect(r.x-o,r.y-o,i,i)}}),a.fillStyle=l.Colors.White.rgba,a.fill()})}}]),t}();n.GameOfLife=g,n.GameOfLifeView=m},{"../../../../Engine/Common/DelayTimer":3,"../../../../Engine/Common/Inputs":7,"../../../../Engine/Drawing/Graphics":13,"../../../../Engine/Game/GameComponents/Effect/Effect":17,"../../../../Engine/Game/GameObject/GameView":19,"../../../../Engine/Game/GameObject/GameVisual":20,"../../../../Engine/Numerics/Vector2":28,"../../../../Engine/UI/Color":33,"../Cell":45,"../CellularAutomata":46}],48:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GameOfLifeWorld=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Game/GameWorld/GameWorld"),o=e("../../Engine/Common/Inputs"),a=e("./CA/GameOfLife/GameOfLife"),s=e("../Resources/GalleryResource");var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GameWorld),r(t,[{key:"initialize",value:function(){this.inputs.addInput(new o.PointerInput)}},{key:"createObjects",value:function(){this.addChild((new a.GameOfLife).joint(new a.GameOfLifeView))}}],[{key:"Title",get:function(){return s.GalleryResources.GameOfLifeWorld_Title}}]),t}();n.GameOfLifeWorld=c},{"../../Engine/Common/Inputs":7,"../../Engine/Game/GameWorld/GameWorld":21,"../Resources/GalleryResource":42,"./CA/GameOfLife/GameOfLife":47}],49:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LSystem=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("./Rule/RuleSet"),o=e("./State/State");var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.states=[],this.ruleSets={},this.root={}}return r(e,[{key:"initRoot",value:function(e){this.root=e,this.states=[],this.states.push(e)}},{key:"addRule",value:function(e){this.ruleSets[e.target]||(this.ruleSets[e.target]=new i.RuleSet),this.ruleSets[e.target].add(e)}},{key:"generate",value:function(){for(var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=function(e){var t=[];n.states.forEach(function(e){n.ruleSets[e.id]?e.children=n.ruleSets[e.id].rules[0].generate(e):e.children=n._getDefaultState(e),n._combineArray(t,e.children)}),n.states=[],n._combineArray(n.states,t)},r=0;r<e;r++)t()}},{key:"_getDefaultState",value:function(e){var t=[];return t.push(new o.State(e.id,e,e.generation+1)),t}},{key:"_combineArray",value:function(t,e){e.forEach(function(e){t.push(e)})}}]),e}();n.LSystem=a},{"./Rule/RuleSet":52,"./State/State":53}],50:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LSystemTreeView=n.LSystemTree=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../Engine/Game/GameObject/GameVisual"),o=e("./State/State"),a=e("./LSystem"),s=e("./Rule/RuleBase"),c=e("../../../Engine/Game/GameObject/GameView"),u=e("../../../Engine/UI/Color"),l=e("../../../Engine/Numerics/Vector2");function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var d=function(e){function t(){f(this,t);var e=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e.LSystem=new a.LSystem,e.LSystem.initRoot(new o.State("F",null,0));return e.LSystem.addRule(new s.RuleGrammar("F",0,"F[+F-F+F+FF]F[-F+F-F-FF]F")),e.depth=3,e.LSystem.generate(e.depth),e}return p(t,i.GameVisual),r(t,[{key:"states",get:function(){return this.LSystem.states}}]),t}(),y=function(e){function t(){f(this,t);var e=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.centerStack=[],e.offsetStack=[],e.lengthStack=[],e.currentIndex=0,e.singleNumber=0,e.rotateRatio=6,e.lineColor=new u.Color(255,255,255,1),e.animation=!0,e}return p(t,c.GameView),r(t,[{key:"render",value:function(e,t){this.animation&&(this.singleNumber=(this.singleNumber+.1*Math.random())%(2*Math.PI),this.rotateRatio=6.2+.3*Math.sin(this.singleNumber),this.centerStack=[],this.offsetStack=[],this.lengthStack=[],this.currentIndex=0,this.lineColor=new u.Color(255,255,255,1),t.clearRect(0,0,e.world.width,e.world.height)),!this.animation&&this.center||(this.center=new l.Vector2(e.world.width/2,.9*e.world.height),this.lengthOfLine=e.world.height*(1/Math.pow(3,e.depth+1))*1,this.offset=new l.Vector2(0,-this.lengthOfLine));for(var n=0,r=this.animation?1e4:1e3,i=e.states,o=this.currentIndex;o<i.length&&(this.mapped(i[o].id,t),this.currentIndex=o+1,!(r<(n+=1)));o++);}},{key:"mapped",value:function(e,t){switch(e){case"F":this.drawLineBranch(t,this.center,this.offset),this.center=this.center.add(this.offset);break;case"M":this.center=this.center.add(this.offset);break;case"+":this.offset=this.offset.rotate(Math.PI/this.rotateRatio);break;case"-":this.offset=this.offset.rotate(-Math.PI/this.rotateRatio);break;case".":this.lengthOfLine*=.618,this.offset.setLength(this.lengthOfLine);break;case"*":this.lengthOfLine/=.618,this.offset.setLength(this.lengthOfLine);break;case"[":this.centerStack.push(this.center.clone()),this.offsetStack.push(this.offset.clone()),this.lengthStack.push(this.lengthOfLine);break;case"]":this.center=this.centerStack.pop(),this.offset=this.offsetStack.pop(),this.lengthOfLine=this.lengthStack.pop()}}},{key:"drawLineBranch",value:function(e,t,n){var r=t.add(n);e.strokeStyle=this.lineColor.rgba,e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(r.x,r.y),e.closePath(),e.stroke()}},{key:"drawCircleBranch",value:function(e,t,n){var r=t.add(n.multiply(.5));e.beginPath(),e.arc(r.x,r.y,n.length/2,0,2*Math.PI,!1),e.closePath(),e.fillStyle=this.lineColor.rgba,e.fill()}}]),t}();n.LSystemTree=d,n.LSystemTreeView=y},{"../../../Engine/Game/GameObject/GameView":19,"../../../Engine/Game/GameObject/GameVisual":20,"../../../Engine/Numerics/Vector2":28,"../../../Engine/UI/Color":33,"./LSystem":49,"./Rule/RuleBase":51,"./State/State":53}],51:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.RuleGrammar=n.RuleBase=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("../State/State");function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function e(t,n){a(this,e),this.target=t,this.priority=n},i=function(e){function i(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";a(this,i);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t));return r.states=n.split(""),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,s),r(i,[{key:"generate",value:function(t){var n=[];return this.states.forEach(function(e){n.push(new o.State(e,t,t.generation+1))}),n}}]),i}();n.RuleBase=s,n.RuleGrammar=i},{"../State/State":53}],52:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rules=[]}return r(e,[{key:"add",value:function(e){this.rules.push(e),this.rules.sort(function(e,t){return e.priority-t.priority})}}]),e}();n.RuleSet=i},{}],53:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.State=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.parent=n,this.children=[],this.generation=r}},{}],54:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LSystemTreeWorld=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Game/GameWorld/GameWorld"),o=e("./LSystem/LSystemTree"),a=e("../Resources/GalleryResource");var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GameWorld),r(t,[{key:"initialize",value:function(){}},{key:"createObjects",value:function(){this.addChild((new o.LSystemTree).joint(new o.LSystemTreeView))}}],[{key:"Title",get:function(){return a.GalleryResources.LSystemTreeWorld_Title}}]),t}();n.LSystemTreeWorld=s},{"../../Engine/Game/GameWorld/GameWorld":21,"../Resources/GalleryResource":42,"./LSystem/LSystemTree":50}],55:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ArrayGrid=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../../Engine/Collections/Array2");function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=function(e){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t));return r.forEach(function(e,t,n){r.data[t][n]=[]}),r.offsetX=[0,-1,0,1,1,1,0,-1,-1],r.offsetY=[0,-1,-1,-1,0,1,1,1,0],r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i.Array2),r(n,[{key:"clear",value:function(){this.forEach(function(e){e.splice(0,e.length)})}},{key:"neighbours",value:function(e,t){for(var n=[],r=0;r<9;r++){var i=e+this.offsetX[r],o=t+this.offsetY[r];0<=i&&i<this.width&&0<=o&&o<this.height&&n.push.apply(n,a(this.data[i][o]))}return n}}]),n}();n.ArrayGrid=o},{"../../../../Engine/Collections/Array2":2}],56:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.FlyerParticle=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("../Particle/DynamicParticle"),s=e("../../../../Engine/Numerics/Vector2");var i=function(e){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t,n));return r.velocityUpon=6,r.neighbourDistance=200,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,o.DynamicParticle),r(i,[{key:"update",value:function(e,t,n){this.alignspeed(e),this.seperate(e),this.cohesion(e),this.seperate(t,5),n&&this.follow(n,3),this.move()}},{key:"alignspeed",value:function(e){var r=this,i=new s.Vector2,o=0;if(this._forEachDistance(e,function(e,t,n){n<r.neighbourDistance&&(i=i.add(e.velocity),o++)}),0<o){(i=i.divide(o)).limitLength(this.velocityUpon);var t=i.subtract(this.velocity);t.limitLength(1),this.applyForce(t)}}},{key:"seperate",value:function(e){var i=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,o=new s.Vector2,a=0;if(this._forEachDistance(e,function(e,t,n){var r=(i.size+e.size)/2+5;0<n&&n<r&&(t.normalize(),t.divide(n),o=o.add(t),a++)}),0<a){(o=o.divide(a)).normalize(),o.multiply(this.velocityUpon);var n=o.subtract(this.velocity);n.limitLength(10),this.applyForce(n.multiply(t))}}},{key:"cohesion",value:function(e){var r=this,i=new s.Vector2,o=0;if(this._forEachDistance(e,function(e,t,n){n<r.neighbourDistance&&(i=i.add(e.location),o++)}),0<o){i=i.divide(o);var t=this.seek(i);t.limitLength(.1),this.applyForce(t)}}},{key:"follow",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;this.applyForce(this.seek(e).multiply(t))}},{key:"checkRadius",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,n=this.location.subtract(e).length,r=175+80*Math.max(.1,Math.min(1,1-n/t)),i=this.color.r+.5*Math.sign(r-this.color.r)*10;this.color.r=this.color.g=this.color.b=i}},{key:"checkBorder",value:function(e){var t=this.location,n=e.width,r=e.height,i=this.size/2+10,o=this.size/2+10;t.x<i?(t.x=i,this.velocity.x*=-1):t.x>n-i&&(t.x=n-i,this.velocity.x*=-1),t.y<o?(t.y=o,this.velocity.y*=-1):t.y>r-o&&(t.y=r-o,this.velocity.y*=-1)}},{key:"seek",value:function(e){return this._seek(this.location,e,this.velocity)}},{key:"_seek",value:function(e,t,n){var r=t.subtract(e);r.normalize(),r.multiply(this.velocityUpon);var i=r.subtract(n);return i.limitLength(1),i}},{key:"_forEachDistance",value:function(e,r){var i=this;e.forEach(function(e){var t=i.location.subtract(e.location),n=t.length;r&&r(e,t,n)})}}]),i}();n.FlyerParticle=i},{"../../../../Engine/Numerics/Vector2":28,"../Particle/DynamicParticle":59}],57:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParticlesFlyerView=n.ParticlesFlyer=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../ParticleSystem"),o=e("../../../../Engine/Numerics/Random"),a=e("../../../../Engine/Game/GameComponents/Effect/Effect"),d=e("../../../../Engine/UI/Color"),y=e("../../../../Engine/Numerics/Vector2"),s=e("./ArrayGrid"),c=e("../../../../Engine/Game/GameObject/GameView"),u=e("../../../../Engine/Drawing/Graphics"),v=e("./FlyerParticle");function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(e){function n(e){l(this,n);var t=f(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.random=new o.Random,t.joint(new a.GhostEffect(new d.Color(0,0,0,.5),10)),t}return h(n,i.ParticlesBase),r(n,[{key:"start",value:function(){var e=this.world.width,t=this.world.height,n=new y.Vector2(.5*e,.5*t);this.flyers=[];for(var r=new y.Vector2(e,t).length,i=parseInt(r/16)/2,o=parseInt(r/60),a=.8*e,s=.8*t,c=0;c<i;c++){var u=new v.FlyerParticle;u.location=n.add(new y.Vector2(a*Math.random()-a/2,s*Math.random()-s/2)),u.velocity=new y.Vector2(10*Math.random()-5,10*Math.random()-5),u.size=2+o*Math.random(),u.color=d.Colors.White,this.flyers.push(u)}this.particles=this.flyers,this.blocks=[];for(var l=2*a,f=2*s,h=0;h<5;h++){var p=new v.FlyerParticle;p.location=n.add(new y.Vector2(l*Math.random()-l/2,f*Math.random()-f/2)),p.velocity=new y.Vector2(0,0),p.size=20+o*Math.random()*20,p.color=d.Colors.Gray,this.blocks.push(p)}this.revolution=20,this.grid=this.createGrid(e,t,this.revolution),this.offset=new y.Vector2(0,0),0===this.world.inputs.pointer.position.length&&(this.world.inputs.pointer.position=new y.Vector2(e/2,t/2))}},{key:"update",value:function(){var t=this,e=this.world.width,n=this.world.height,r=new y.Vector2(e/2,n/2);this.grid.clear(),this.offset=this.getAverateLocation(this.particles).subtract(r);var i=null;this.world.inputs.pointer.isPressed&&(i=this.world.inputs.pointer.position.add(this.offset)),this.flyers.forEach(function(e){e.update(t.flyers,t.blocks,i)})}},{key:"createGrid",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:10,r=Math.ceil(e/n),i=Math.ceil(t/n);return new s.ArrayGrid(r,i)}},{key:"allocateGrid",value:function(n,e,r){var i=this,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:10;e.forEach(function(e){var t=i.mapLocation(e.location.subtract(r),o);t.x=Math.min(n.width-1,Math.max(0,t.x)),t.y=Math.min(n.height-1,Math.max(0,t.y)),n.get(t.x,t.y).push(e)})}},{key:"mapLocation",value:function(e,t){var n=Math.floor(e.x/t),r=Math.floor(e.y/t);return new y.Vector2(n,r)}},{key:"getAverateLocation",value:function(e){if(0<e.length){var t=new y.Vector2;return e.forEach(function(e){t=t.add(e.location)}),t.divide(e.length)}return new y.Vector2}}]),n}(),g=function(e){function t(){l(this,t);var e=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.rotation=0,e}return h(t,c.GameView),r(t,[{key:"render",value:function(e,t){var n=this;u.Graphics.scaleOffset(t,-1,-1,1),u.Graphics.hold(t,function(){t.translate(-e.offset.x,-e.offset.y),n.drawGrid(t,e.world.size,e.offset),e.particles.forEach(function(e){n.drawParticle(t,e)}),e.blocks.forEach(function(e){n.drawParticle(t,e)}),n.drawInfo(t,e.world.size),t.translate(e.offset.x,e.offset.y)})}},{key:"drawParticle",value:function(e,t){var n=t.location;e.beginPath(),e.arc(n.x,n.y,t.size/2,0,2*Math.PI,!1),e.closePath(),e.fillStyle=t.color.rgba,e.fill()}},{key:"drawGrid",value:function(e,t,n){var r=Math.max(t.width,t.height)/20,i=Math.ceil(t.width/r)+1,o=Math.ceil(t.height/r)+1,a=Math.ceil(n.x/r),s=Math.ceil(n.y/r),c=a*r,u=s*r;e.beginPath();for(var l=-1;l<i;l++)for(var f=l*r+c,h=-1;h<o;h++)if((l+h+a+s)%2==0){var p=h*r+u;e.rect(f,p,r,r)}e.closePath(),e.fillStyle="rgba(255,255,255,0.05)",e.fill()}},{key:"drawInfo",value:function(e,t){var n=Math.max(t.width/20,32);e.font=n+"px Arial",e.textAlign="center",e.fillStyle="#FFF",e.fillText("Press And Move Pointer!",t.center.x,t.center.y)}}]),t}();n.ParticlesFlyer=p,n.ParticlesFlyerView=g},{"../../../../Engine/Drawing/Graphics":13,"../../../../Engine/Game/GameComponents/Effect/Effect":17,"../../../../Engine/Game/GameObject/GameView":19,"../../../../Engine/Numerics/Random":26,"../../../../Engine/Numerics/Vector2":28,"../../../../Engine/UI/Color":33,"../ParticleSystem":60,"./ArrayGrid":55,"./FlyerParticle":56}],58:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Particle=void 0;var i=e("../../../Engine/UI/Color");n.Particle=function e(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.location=t,this.size=n,this.age=r,this.color=new i.Color(0,0,0,1),this.dead=!1}},{"../../../Engine/UI/Color":33}],59:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DynamicParticle=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("../Particle"),a=e("../../../../Engine/Numerics/Vector2");var i=function(e){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t,n));return r.velocity=new a.Vector2(0,0),r.acceleration=new a.Vector2(0,0),r.mass=10,r.velocityUpon=Number.POSITIVE_INFINITY,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,o.Particle),r(i,[{key:"applyForce",value:function(e){this.acceleration=this.acceleration.add(e.divide(this.mass))}},{key:"move",value:function(){this.velocity=this.velocity.add(this.acceleration),this.velocity.limitLength(this.velocityUpon),this.location=this.location.add(this.velocity),this.acceleration=new a.Vector2(0,0)}},{key:"moveTo",value:function(e){this.location=e,this.velocity.setLength(0)}}]),i}();n.DynamicParticle=i},{"../../../../Engine/Numerics/Vector2":28,"../Particle":58}],60:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParticlesBase=void 0;var r=e("../../../Engine/Game/GameObject/GameVisual");var i=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.particles=[],e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.GameVisual),t}();n.ParticlesBase=i},{"../../../Engine/Game/GameObject/GameVisual":20}],61:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParticlesTreeView=n.ParticlesTree=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../../Engine/UI/Color"),o=e("../../../../Engine/Numerics/Vector2"),a=e("../../../../Engine/Numerics/Random"),s=e("../ParticleSystem"),c=e("./SpotParticle"),u=e("../../../../Engine/Game/GameObject/GameView");function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(e){function t(){l(this,t);var e=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.spots=[],e.generation=[],e.random=new a.Random,e.settings={update:!0,updateIndex:0,updateMax:1e3,drawIndex:0,drawMax:1e3},e}return h(t,s.ParticlesBase),r(t,[{key:"start",value:function(){var e=Math.min(this.world.width,this.world.height),t=e/2500*Math.log10(e),n=new o.Vector2(this.world.width/2,.5*this.world.height+.8*e),r=new c.SpotParticle(n);r.velocity=new o.Vector2(0,-16*t),r.size=256*t,r.age=20,r.color=new i.Color(0,0,0),this.spots.push(r),this.particles=this.spots}},{key:"update",value:function(){if(this.settings.update){for(var e,t=0,n=this.settings.updateIndex;n<this.spots.length;n++){if(this.spots[n].update(this.generation,Math.ceil(this.random.normal(1,3))),t+=1,this.settings.updateIndex+=1,t>this.settings.updateMax)break}if(this.settings.updateIndex>=this.spots.length)this.settings.updateIndex=0,this.settings.update=!1,(e=this.spots).push.apply(e,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(this.generation)),this.generation=[],this.spots=this.spots.filter(function(e){return!e.isDead}),this.particles=this.spots}}}]),t}(),d=function(e){function t(){return l(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h(t,u.GameView),r(t,[{key:"render",value:function(e,t){this.drawByFillCircle(e,t)}},{key:"drawByFillCircle",value:function(e,t){for(var n=2*Math.PI,r=0,i=e.settings.drawIndex;i<e.particles.length;i++){var o=e.particles[i],a=o.location;if(t.beginPath(),t.arc(a.x,a.y,o.size/2,0,n,!1),t.fillStyle=o.color.rgb,t.fill(),r+=1,e.settings.drawIndex+=1,r>e.settings.drawMax)return}e.settings.drawIndex=0,e.settings.update=!0}}]),t}();n.ParticlesTree=p,n.ParticlesTreeView=d},{"../../../../Engine/Game/GameObject/GameView":19,"../../../../Engine/Numerics/Random":26,"../../../../Engine/Numerics/Vector2":28,"../../../../Engine/UI/Color":33,"../ParticleSystem":60,"./SpotParticle":62}],62:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SpotParticle=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../Particle/DynamicParticle"),a=e("../../../../Engine/Numerics/Random"),s=e("../../../../Engine/Numerics/Vector2"),c=e("../../../../Engine/UI/Color");var o=function(e){function o(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,e,t,n));return r.angleOffset=.024*Math.random()-.012,r.velocityUpon=16,r.random=new a.Random,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(o,i.DynamicParticle),r(o,[{key:"update",value:function(e,t){0<this.age&&(this.age-=1,this.size=this.size*u.sizeRadius,this.velocity=this.velocity.rotate(this.angleOffset*u.rotateRatio),this.velocity=this.velocity.rotate(this.random.normal(-100,100)*u.rotateRatioRandom),this.color=c.ColorHelper.gradient(this.color,u.gradientColorIncrement),this.velocityUpon=.32*this.size,this.move()),this.size>u.sizeMinimum?Math.random()<u.divideRatio&&this.divide(e,t):(this.velocity=new s.Vector2(-1,-1),this.isDead=!0)}},{key:"divide",value:function(e,t){t<2&&(t=2);var n=this.size*u.divideSizeRatio;if(this.size=n,this.age=this.random.normal(0,20),1<t)for(var r=2;r<=t;r++){n*=u.divideSizeRatioEx;var i=new o(this.location,n);i.velocity=this.velocity.rotate(this.random.normal(-100,100)*u.divideRotateRatio).multiply(u.divideLengthRatio),i.age=this.random.normal(0,40),i.color=c.ColorHelper.gradient(this.color,u.gradientColorIncrement),i.color.a=.96,e.push(i)}}}]),o}(),u={sizeMinimum:1,sizeRadius:.995,rotateRatio:.01,rotateRatioRandom:.003,divideRatio:.03,divideSizeRatio:.8,divideSizeRatioEx:.92,divideColorIncrementRatio:1,divideRotateRatio:.012,divideLengthRatio:.7,gradientColorIncrement:1.1};n.SpotParticle=o},{"../../../../Engine/Numerics/Random":26,"../../../../Engine/Numerics/Vector2":28,"../../../../Engine/UI/Color":33,"../Particle/DynamicParticle":59}],63:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParticlesWalkerView=n.ParticlesWalker=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),c=e("../../../../Engine/UI/Color"),i=e("../../../../Engine/Numerics/Vector2"),o=e("../../../../Engine/Numerics/Random"),a=e("../ParticleSystem"),u=e("./WalkerParticle"),s=e("../../../../Engine/Numerics/Transform"),l=e("../../../../Engine/Game/GameComponents/Effect/Effect"),f=e("../../../../Engine/Game/GameObject/GameView"),h=e("../../../../Engine/Drawing/Graphics");function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=function(e){function t(){p(this,t);var e=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.random=new o.Random,e.joint(new l.GhostEffect(new c.Color(0,128,128,.006),40)),e.transform=new s.Transform,e}return y(t,a.ParticlesBase),r(t,[{key:"start",value:function(){var e=this.world.width,t=this.world.height;this.walkers=[],this.split=1;var n=new i.Vector2(e/2,.8*t);this.center=n,u.WalkerParticle.StaticGravityRatio=5e3;var r=new u.WalkerParticle(n);r.origin=r.location.clone(),r.maxSize=10,r.color=new c.Color(255,255,255,.1),r.direction=new i.Vector2(0,-this.world.width/10),this.walkers.push(r),this.maxDepth=6+parseInt(e/600),this.createNodes(this.walkers,r,this.maxDepth,this.split,1),this.rotationDelta=2*Math.PI/Math.floor(8*Math.random()+2),this.particles=this.walkers}},{key:"update",value:function(){var n=this,r={width:this.world.width,height:this.world.height};this.transform.center=new i.Vector2(r.width/2,r.height/2),this.transform.rotation=this.transform.rotation+this.rotationDelta,this.walkers.forEach(function(e,t){e.update(r,0===t?n.center:e.parent.location)}),.5<Math.random()&&(this.split+=1.6*Math.random()-.8,this.split=Math.max(1,Math.min(16,this.split))),this.modifyNodes(this.walkers[0],this.split,1*this.split/10)}},{key:"createNodes",value:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1;if(0<n){var o=[-1,1,0];t.children=[];for(var a=0;a<2;a++){var s=new u.WalkerParticle;s.direction=t.direction.rotate(Math.PI/r*o[a]),s.location=t.location.add(s.direction.multiply(i)),s.origin=s.location.clone(),s.parent=t,s.maxSize=.8*t.maxSize,s.color=new c.Color(255,255,255,1/this.maxDepth-.05*n),t.children.push(s),this.walkers.push(s),this.createNodes(e,s,n-1,r,i)}}}},{key:"modifyNodes",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;if(e.children&&0<e.children.length)for(var r=[-1,1,0],i=0;i<2;i++){var o=e.children[i];o.direction=e.direction.rotate(Math.PI/t*r[i]),o.origin=e.origin.add(o.direction.multiply(n)),this.modifyNodes(o,t,n)}}}]),t}(),g=function(e){function t(){return p(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,f.GameView),r(t,[{key:"render",value:function(r,i){h.Graphics.transform(i,r.transform.toMatrix3x2(),function(){for(var e=0;e<r.particles.length;e++){var t=r.particles[e],n=t.location;t.parent&&(i.beginPath(),i.moveTo(n.x,n.y),i.lineTo(t.parent.location.x,t.parent.location.y),i.lineWidth=t.size,i.strokeStyle=t.color.rgba,i.closePath(),i.stroke())}})}}]),t}();n.ParticlesWalker=v,n.ParticlesWalkerView=g},{"../../../../Engine/Drawing/Graphics":13,"../../../../Engine/Game/GameComponents/Effect/Effect":17,"../../../../Engine/Game/GameObject/GameView":19,"../../../../Engine/Numerics/Random":26,"../../../../Engine/Numerics/Transform":27,"../../../../Engine/Numerics/Vector2":28,"../../../../Engine/UI/Color":33,"../ParticleSystem":60,"./WalkerParticle":64}],64:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.WalkerParticle=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../Particle/DynamicParticle"),o=e("../../../../Engine/Numerics/Random");var a=function(e){function s(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,e,t,n));return r.random=new o.Random,r.maxSize=1,r.maxAge=300,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(s,i.DynamicParticle),r(s,[{key:"update",value:function(e,t){this.age<this.maxAge&&(this.age+=1,this.size=this.maxSize*this.age/this.maxAge,this.mass=this.size*this.size*this.size,this.velocityUpon=this.size/2);var n=t.subtract(this.location),r=n.length;if(r<this.size/2)this.age=0,this.size=1,this.mass=1,this.location=this.origin.clone();else{var i=n.normalize(),o=s.StaticGravityRatio||0,a=i.multiply(this.mass/(r*r)*o);this.applyForce(a)}this.move()}}]),s}();n.WalkerParticle=a},{"../../../../Engine/Numerics/Random":26,"../Particle/DynamicParticle":59}],65:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParticlesFlyerWorld=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Game/GameWorld/GameWorld"),o=e("../../Engine/Common/Inputs"),a=e("./ParticleSystem/Flyer/ParticlesFlyer"),s=e("../Resources/GalleryResource");var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GameWorld),r(t,[{key:"initialize",value:function(){this.inputs.addInput(new o.PointerInput)}},{key:"createObjects",value:function(){this.addChild((new a.ParticlesFlyer).joint(new a.ParticlesFlyerView))}}],[{key:"Title",get:function(){return s.GalleryResources.ParticlesFlyerWorld_Title}}]),t}();n.ParticlesFlyerWorld=c},{"../../Engine/Common/Inputs":7,"../../Engine/Game/GameWorld/GameWorld":21,"../Resources/GalleryResource":42,"./ParticleSystem/Flyer/ParticlesFlyer":57}],66:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParticlesTreeWorld=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Game/GameWorld/GameWorld"),o=e("./ParticleSystem/Tree/ParticlesTree"),a=e("../Resources/GalleryResource");var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GameWorld),r(t,[{key:"initialize",value:function(){}},{key:"createObjects",value:function(){this.addChild((new o.ParticlesTree).joint(new o.ParticlesTreeView))}}],[{key:"Title",get:function(){return a.GalleryResources.ParticlesTreeWorld_Title}}]),t}();n.ParticlesTreeWorld=s},{"../../Engine/Game/GameWorld/GameWorld":21,"../Resources/GalleryResource":42,"./ParticleSystem/Tree/ParticlesTree":61}],67:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParticlesWalkerWorld=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Game/GameWorld/GameWorld"),o=e("../../Engine/Common/Inputs"),a=e("./ParticleSystem/Walker/ParticlesWalker"),s=e("../Resources/GalleryResource");var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GameWorld),r(t,[{key:"initialize",value:function(){this.inputs.addInput(new o.PointerInput)}},{key:"createObjects",value:function(){this.addChild((new a.ParticlesWalker).joint(new a.ParticlesWalkerView))}}],[{key:"Title",get:function(){return s.GalleryResources.PartilesWalkerWorld_Title}}]),t}();n.ParticlesWalkerWorld=c},{"../../Engine/Common/Inputs":7,"../../Engine/Game/GameWorld/GameWorld":21,"../Resources/GalleryResource":42,"./ParticleSystem/Walker/ParticlesWalker":63}],68:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.VisualPointer=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../Engine/Game/GameObject/GameVisual"),o=e("../../../Engine/Game/GameObject/GameView"),a=e("../../../Engine/Drawing/Graphics"),s=e("../../../Engine/Common/Inputs");function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f=function(e){function t(){c(this,t);var e=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.pointers=[],e.cache={},e.joint(new h),e}return l(t,i.GameVisual),r(t,[{key:"start",value:function(e){var t=this;this.cache.container=e.world.ui.container,this.cache.cursor=this.cache.container.style.cursor,this.cache.container.style.cursor="none",this.cache.handler=function(){t.pointers.push(e.world.inputs.pointer.position.clone())},e.on(s.InputEvents.PointerMoved,this.cache.handler)}},{key:"update",value:function(){1<this.pointers.length&&this.pointers.shift()}},{key:"dispose",value:function(e){(function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this),this.cache.container.style.cursor=this.cache.cursor,e.off(s.InputEvents.PointerMoved,this.cache.handler)}}]),t}(),h=function(e){function t(){return c(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,o.GameView),r(t,[{key:"render",value:function(e,t){a.Graphics.hold(t,function(){0<e.pointers.length&&(t.beginPath(),e.pointers.forEach(function(e){t.lineTo(e.x,e.y)}),t.lineWidth=10,t.strokeStyle="#FFF",t.stroke())})}}]),t}();n.VisualPointer=f},{"../../../Engine/Common/Inputs":7,"../../../Engine/Drawing/Graphics":13,"../../../Engine/Game/GameObject/GameView":19,"../../../Engine/Game/GameObject/GameVisual":20}],69:[function(e,t,n){"use strict";var r=e("./Gallery/GalleryStarter"),i=e("./Gallery/Resources/GalleryResource"),o=e("./Engine/Platform/PlatformInfo"),a=null,s=null;function c(){var e=document.getElementById("canvas");e.width=window.document.body.clientWidth,e.height=window.document.body.clientHeight,i.GalleryResourceManager.load(function(){a=new r.GalleryStarter,$("#button-restart").attr("title",i.GalleryResources.Tooltips.Restart),$("#button-fullscreen").attr("title",i.GalleryResources.Tooltips.Fullscreen),$(function(){$("[data-toggle='tooltip']").tooltip()}),function(){if("unknown"==sessionStorage.getItem("warningFlag")&&o.PlatformInfo.IsMobile){sessionStorage.setItem("warningFlag","known");var e=i.GalleryResources.Warnings.OpenOnPC,t=$('                \n        <div class="alert alert-warning alert-dismissible fade show" role="alert">\n            <strong>'+e.Title+"</strong> "+e.Content+'\n            <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n                <span aria-hidden="true">&times;</span>\n            </button>\n        </div>\n        ');$("#alert-container").append(t),setTimeout(function(){t.alert("close")},6e3)}}(),function(){if(!u){u=!0;var e=$("#dropdown-gallery"),t=a.symbols;for(var n in t)e.append($('<a class="dropdown-item" href="./gallery.html?scene='+n+'">'+t[n].Title+"</a>"))}}(),(s=a.launch(document.getElementById("canvas-container"),e)).frameManager.onRateChanged=function(e){var t=$("#text-frame");t&&t.text(e)},s.run()})}!function(){window.addEventListener("resize",function(){s.stop(),c()}),$("#button-restart").click(function(){s.stop(),c()});var t=!0;$("#button-fullscreen").click(function(){["ms","moz","webkit"].map(function(e){return e+(t?"RequestFullscreen":"ExitFullscreen")}).forEach(function(e){t?document.documentElement[e]&&document.documentElement[e]():document[e]&&document[e]()}),t=!t}),sessionStorage.getItem("warningFlag")||sessionStorage.setItem("warningFlag","unknown")}(),c();var u=!1},{"./Engine/Platform/PlatformInfo":29,"./Gallery/GalleryStarter":35,"./Gallery/Resources/GalleryResource":42}]},{},[69]);