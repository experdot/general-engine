!function o(a,s,u){function c(t,e){if(!s[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var i=s[t]={exports:{}};a[t][0].call(i.exports,function(e){return c(a[t][1][e]||e)},i,i.exports,o,a,s,u)}return s[t].exports}for(var l="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var i=function(){function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.width=e,this.height=t,this.data=[];for(var n=0;n<e;n++){this.data.push([]);for(var r=0;r<t;r++)this.data[n][r]=void 0}}return r(i,[{key:"set",value:function(e,t,n){return this.data[e][t]=n,this.data[e][t]}},{key:"get",value:function(e,t){return this.data[e][t]}},{key:"forEach",value:function(r){this.data.forEach(function(e,n){e&&e.forEach(function(e,t){r&&r(e,n,t)})})}}]),i}();n.Array2=i},{}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reset()}return r(e,[{key:"reset",value:function(){return this.lastTime=(new Date).getTime(),this}},{key:"delay",value:function(e,t,n){var r=(new Date).getTime(),i=r-this.lastTime;e<=i?(this.lastTime=r,t&&t(i)):n&&n(i)}}]),e}();n.DelayTimer=i},{}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"create",value:function(e){return Object.freeze(e)}}]),e}();n.Enum=i},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.EventSystem=n.StrictMode=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("./Exception");var o=e("./Enum").Enum.create({None:0,Strict:1}),a=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:o.None;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.mode=e,this.handlers={},this.dom0Events=[],this.dom2Events=[]}return r(t,[{key:"addHandler",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if((this.strict===o.None||n)&&this.registEvent(e),!this.handlers[e])throw new i.InvalidOperationException("The event is not registed.");return this.handlers[e].push(t),t}},{key:"removeHandler",value:function(e,t){var n=this.handlers[e];if(n&&0<n.length){var r=n.findIndex(function(e){return e===t});0<=r&&n.splice(r,1)}}},{key:"registEvent",value:function(e){this.handlers[e]||(this.handlers[e]=[])}},{key:"registSystemEventByDom0",value:function(e,t,n){var r=this;this.handlers[t]||(this.handlers[t]=[],n&&e&&(e[n]=function(e){r.raiseEvent(t,e)},this.dom0Events.push({ui:e,name:n})))}},{key:"registSystemEventByDom2",value:function(e,t,n,r){var i=this;if(!this.handlers[t]&&(this.handlers[t]=[],n&&e)){var o=function(e){i.raiseEvent(t,e)};e.addEventListener(n,o,r),this.dom2Events.push({ui:e,name:n,listener:o})}}},{key:"raiseEvent",value:function(e,t){this.handlers[e]&&this.handlers[e].forEach(function(e){e(t)})}},{key:"release",value:function(){this.dom0Events.forEach(function(e){e.ui[e.name]=null}),this.dom2Events.forEach(function(e){e.ui.removeEventListener(e.name,e.listener)})}}]),t}();n.StrictMode=o,n.EventSystem=a},{"./Enum":3,"./Exception":5}],5:[function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function e(t){o(this,e),this.message=t},s=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"One of the arguments provided to a method is not valid.";return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,a),t}(),u=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"An undefined/null reference is passed to a method that does not accept it as a valid argument.";return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,s),t}(),c=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"The value of an argument is outside the allowable range of values as defined by the invoked method.";return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,s),t}(),l=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"An attempt is made to access an element of an array or collection with an index that is outside its bounds.";return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,a),t}(),f=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"A method call is invalid for the object's current state.";return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,a),t}(),h=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"The key specified for accessing an element in an object does not match any key in the object.";return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,a),t}(),p=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"The method is not implemented.";return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,a),t}(),d=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"An invoked method is not supported.";return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,a),t}(),y=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"A feature does not run on a particular platform.";return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,a),t}(),v=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"An array with the wrong number of dimensions is passed to a method.";return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,a),t}(),m=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"The time interval allotted to an operation has expired.";return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,a),t}();n.Exception=a,n.ArgumentException=s,n.ArgumentNullException=u,n.ArgumentOutOfRangeException=c,n.IndexOutOfRangeException=l,n.InvalidOperationException=f,n.KeyNotFoundException=h,n.NotImplementedException=p,n.NotSupportedException=d,n.PlatformNotSupportedException=y,n.RankException=v,n.TimeoutException=m},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DragDropInput=n.KeyInput=n.PointerInput=n.TouchInput=n.MouseInput=n.InputBase=n.Inputs=void 0;var r=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("../../Engine/Numerics/Vector2"),a=e("./Exception");function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l=function(){function e(){c(this,e),this.inputList=[],this.onchange=function(){throw new a.NotSupportedException("The onchange event hanlder is not configured.")}}return i(e,[{key:"change",value:function(e){return this.onchange=e,this}},{key:"launch",value:function(e){var t=this;return this.release(),this.ui=e,this.inputList.forEach(function(e){t.regist(e)}),this}},{key:"release",value:function(){this.inputList.forEach(function(e){e.release()}),this.ui=null}},{key:"regist",value:function(e){e.regist(this)}},{key:"addInput",value:function(e){this.inputList.push(e)}}]),e}(),f=function(){function e(){c(this,e),this.events=[]}return i(e,[{key:"regist",value:function(e){this.inputs=e}},{key:"registEvent",value:function(e,t,n,r){var i=this,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,a=function(e){n&&n(e),i.inputs.onchange,i.inputs.onchange(t,e),r&&r(e)};(o=o||this.inputs.ui).addEventListener(e,a),this.events.push({ui:o,name:e,listener:a})}},{key:"release",value:function(){this.events.forEach(function(e){e.ui.removeEventListener(e.name,e.listener)})}}]),e}(),h=function(e){function t(){return c(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,f),i(t,[{key:"regist",value:function(e){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"regist",this).call(this,e),e.mouse||(e.mouse={isPressed:!1,position:new o.Vector2(0,0)}),this._registMouseEvent(e)}},{key:"_registMouseEvent",value:function(t){this.registEvent("click","Click"),this.registEvent("mouseenter","MouseEnter"),this.registEvent("mouseleave","MouseLeave",function(){t.mouse.isPressed=!1}),this.registEvent("mousedown","MouseDown",function(){t.mouse.isPressed=!0}),this.registEvent("mouseup","MouseUp",function(){t.mouse.isPressed=!1}),this.registEvent("mousemove","MouseMove",function(e){t.mouse.position=new o.Vector2(e.offsetX,e.offsetY)}),window.onmousewheel=document.onmousewheel=function(e){t.onchange&&t.onchange("MouseWheel",e)}}}]),t}(),p=function(e){function t(){return c(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,f),i(t,[{key:"regist",value:function(e){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"regist",this).call(this,e),e.touch||(e.touch={isTouching:!1,position:new o.Vector2(0,0)}),this._registTouchEvent(e)}},{key:"_registTouchEvent",value:function(t){this.registEvent("tap","Tap"),this.registEvent("touchStart","TouchStart",function(){t.touch.isTouching=!0}),this.registEvent("touchEnd","TouchEnd",function(){t.touch.isTouching=!1}),this.registEvent("touchmove","TouchMove",function(e){e.preventDefault(),t.touch.position=new o.Vector2(e.changedTouches[0].clientX,e.changedTouches[0].clientY)})}}]),t}(),d=function(e){function t(){return c(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,f),i(t,[{key:"regist",value:function(e){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"regist",this).call(this,e),e.pointer||(e.pointer={isPressed:!1,position:new o.Vector2(0,0)}),this._registMouseEvent(e),this._registTouchEvent(e)}},{key:"_registMouseEvent",value:function(t){this.registEvent("click","PointerClicked"),this.registEvent("mouseenter","PointerEntered"),this.registEvent("mouseleave","PointerExited",function(){t.pointer.isPressed=!1}),this.registEvent("mousedown","PointerPressed",function(){t.pointer.isPressed=!0}),this.registEvent("mouseup","PointerReleased",function(){t.pointer.isPressed=!1}),this.registEvent("mousemove","PointerMoved",function(e){t.pointer.position=new o.Vector2(e.offsetX,e.offsetY)}),window.onmousewheel=document.onmousewheel=function(e){t.handler("PointerWheelChanged",e)}}},{key:"_registTouchEvent",value:function(t){this.registEvent("tap","PointerClicked"),this.registEvent("touchstart","PointerPressed",function(){t.pointer.isPressed=!0}),this.registEvent("touchend","PointerReleased",function(){t.pointer.isPressed=!1}),this.registEvent("touchmove","PointerMoved",function(e){e.preventDefault(),t.pointer.isPressed=!0,t.pointer.position=new o.Vector2(e.changedTouches[0].clientX,e.changedTouches[0].clientY)})}}]),t}(),y=function(e){function t(){return c(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,f),i(t,[{key:"regist",value:function(e){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"regist",this).call(this,e),e.key||(e.key={isKeyDown:!1}),this.registEvent("keydown","KeyDown",function(){e.key.isKeyDown=!0},null,document),this.registEvent("keyup","KeyUp",function(){e.key.isKeyDown=!1},null,document),this.registEvent("keypress","KeyPress",null,null,document)}}]),t}(),v=function(e){function t(){return c(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,f),i(t,[{key:"regist",value:function(e){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"regist",this).call(this,e),this.registEvent("drop","Drop",function(e){e.stopPropagation(),e.preventDefault()}),this.registEvent("dragenter","DragEnter",function(e){e.stopPropagation(),e.preventDefault()}),this.registEvent("dragexit","DragExit",function(e){e.stopPropagation(),e.preventDefault()}),this.registEvent("dragover","DragOver",function(e){e.stopPropagation(),e.preventDefault()})}}]),t}();n.Inputs=l,n.InputBase=f,n.MouseInput=h,n.TouchInput=p,n.PointerInput=d,n.KeyInput=y,n.DragDropInput=v},{"../../Engine/Numerics/Vector2":23,"./Exception":5}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GeneralObject=void 0;var i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("./GeneralProcess");var r=function(){function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.attachements=[]}return i(r,[{key:"proxy",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new r,n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return o.GeneralProcess.find(e).forEach(function(e){e.value.setSource(t)}),n&&this.sync(e),e}},{key:"attach",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.attachements.push(e),t&&this.sync(e)}},{key:"sync",value:function(n){var r=this;o.GeneralProcess.find(n).forEach(function(e){var t=r[e.key],i=n[e.key];i&&t instanceof o.GeneralProcess&&i instanceof o.GeneralProcess&&t.next(function(e){for(var t=arguments.length,n=Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return i.process.apply(i,n)})})}}]),r}();n.GeneralObject=r},{"./GeneralProcess":8}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GeneralProcess=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("./GeneralTask");function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var i=function(){function i(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.source=e,this.tasks=[]}return r(i,null,[{key:"find",value:function(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];r instanceof i&&t.push({key:n,value:r})}return t}}]),r(i,[{key:"setSource",value:function(e){this.source=e}},{key:"process",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];this.tasks.forEach(function(e){e.run.apply(e,[t.source,t.source].concat(n))})}},{key:"before",value:function(){for(var e,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this.tasks).unshift.apply(e,a(n.map(function(e){return new o.GeneralTask(e)}))),this}},{key:"next",value:function(){for(var e,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this.tasks).push.apply(e,a(n.map(function(e){return new o.GeneralTask(e)}))),this}},{key:"insert",value:function(e){for(var t,n=arguments.length,r=Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this.tasks).splice.apply(t,[e,0].concat(a(r.map(function(e){return new o.GeneralTask(e)})))),this}},{key:"clear",value:function(){this.tasks=[]}}]),i}();n.GeneralProcess=i},{"./GeneralTask":9}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var r=function(){function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.action=e,this.name=t,this.enabled=n}return i(r,[{key:"run",value:function(e){for(var t,n=arguments.length,r=Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.enabled&&this.action&&(t=this.action).call.apply(t,[e].concat(r))}}]),r}();n.GeneralTask=r},{}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var i=function(){function c(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c)}return r(c,null,[{key:"clear",value:function(e){e.clearRect(0,0,e.canvas.width,e.canvas.height)}},{key:"offsetScale",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,i=e.canvas.width,o=e.canvas.height,a=i+t,s=o+n;c.hold(e,function(){e.globalAlpha=r,e.translate(i/2,o/2),e.drawImage(e.canvas,-a/2,-s/2,a,s)})}},{key:"rotate",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,r=arguments[3],i=e.canvas.width,o=e.canvas.height,a=i/2,s=o/2;c.hold(e,function(){e.translate(a,s),e.rotate(t),e.translate(-a,-s),e.globalAlpha=n,r&&r(e)})}},{key:"mirror",value:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,i=arguments[4],o=e.canvas.width,a=e.canvas.height,s=o/2,u=a/2;c.hold(e,function(){e.translate(s,u),e.scale(t,n),e.translate(-s,-u),e.globalAlpha=r,i&&i(e)})}},{key:"transform",value:function(e,t,n){c.hold(e,function(){e.setTransform.apply(e,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t.toArray())),n&&n(e)})}},{key:"hold",value:function(e,t){e.save(),t&&t(e),e.restore()}}]),c}();n.Graphics=i},{}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var i=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=e,this.canvas.height=t}return r(n,[{key:"clear",value:function(){return this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this}},{key:"draw",value:function(e){return e&&e(this.context),this}},{key:"output",value:function(e){for(var t=arguments.length,n=Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.drawImage.apply(e,[this.canvas].concat(n)),this}}]),n}();n.OffscreenCanvas=i},{}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AnimationBox=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("./FrameManager");var o=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.canvas=e,this.context=e.getContext("2d"),this.world=t,this.world.initializeUI(e),this.frameManager=new i.FrameManager}return r(n,[{key:"run",value:function(){var e=this;this.world.start.process(),this.frameManager.loopInvoke(function(){e.world.view.render.process(e.context),e.world.update.process()})}},{key:"stop",value:function(){var e=this;this.frameManager.stop(function(){e.context.clearRect(0,0,e.canvas.width,e.canvas.height)}),this.world.dispose.process()}}]),n}();n.AnimationBox=o},{"./FrameManager":13}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.FrameManager=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Common/DelayTimer");var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isLoop=!1,this.frameCount=0,this.framePerSecond=0,this.lastSecondCount=0,this.timer=new i.DelayTimer,this.onRateChanged=null}return r(e,[{key:"loopInvoke",value:function(){var n=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this.isLoop=!0;var r=void 0;!function e(){t&&t(),n.frameCount+=1,n.timer.delay(1e3,function(e){var t=1e3===e?0:-1;n.framePerSecond=n.frameCount-n.lastSecondCount+t,n.lastSecondCount=n.frameCount,n.onRateChanged&&n.onRateChanged(n.framePerSecond)}),n.isLoop?r=window.requestAnimationFrame(e):(window.cancelAnimationFrame(r),n.frameCount=0,n.framePerSecond=0,n.lastSecondCount=0,n.stopCallback&&n.stopCallback())}()}},{key:"stop",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this.stopCallback=e,this.isLoop=!1}}]),e}();n.FrameManager=o},{"../../Common/DelayTimer":2}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GhostEffect=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("../../../UI/Color"),a=e("../../GameObject/GameVisual");var i=function(e){function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:o.Colors.Black,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:10,n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return r.fillColor=e,r.gradientNumber=t,n&&r.start.next(function(e){e.view.render.before(function(e,t){r.effect(t)})}),r.update.next(function(){.5<Math.random()&&(r.fillColor=o.ColorHelper.gradientRandom(r.fillColor,r.gradientNumber))}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,a.GameVisual),r(i,[{key:"effect",value:function(e){var t=e.canvas.width,n=e.canvas.height;e.fillStyle=this.fillColor.rgba,e.fillRect(0,0,t,n)}}]),i}();n.GhostEffect=i},{"../../../UI/Color":24,"../../GameObject/GameVisual":16}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GameView=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Core/GeneralObject"),o=e("../../Core/GeneralProcess");var a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.target=void 0,e.render=new o.GeneralProcess(e).next(e.draw),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GeneralObject),r(t,[{key:"draw",value:function(){}}]),t}();n.GameView=a},{"../../Core/GeneralObject":7,"../../Core/GeneralProcess":8}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GameVisual=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Core/GeneralObject"),o=e("../../Numerics/Transform"),a=e("../../Common/EventSystem"),s=e("../../Core/GeneralProcess");var u=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.start=new s.GeneralProcess(e),e.update=new s.GeneralProcess(e),e.dispose=new s.GeneralProcess(e),e.transform=new o.Transform,e.eventSystem=new a.EventSystem,e.dispose.next(function(){e.eventSystem.release()}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GeneralObject),r(t,[{key:"bind",value:function(e){(this.view=e).target=this}},{key:"on",value:function(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];this.eventSystem.addHandler(e,t,n)}},{key:"off",value:function(e,t){this.eventSystem.removeHandler(e,t)}}]),t}();n.GameVisual=u},{"../../Common/EventSystem":4,"../../Core/GeneralObject":7,"../../Core/GeneralProcess":8,"../../Numerics/Transform":22}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GameWorld=void 0;var i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("../../Common/Inputs"),a=e("../GameObject/GameVisual"),s=e("../GameObject/GameView"),u=e("../../Core/GeneralProcess");var r=function(e){function r(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return n.width=e,n.height=t,n.visuals=[],n.inputs=(new o.Inputs).change(function(e,t){return n.raiseEvent(e,t)}),n.initialize(),n.createObjects(),u.GeneralProcess.find(n).forEach(function(t){t.value.next(function(){n.visuals.forEach(function(e){e[t.key].process()})})}),n.dispose.next(function(){return n.inputs.release()}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,a.GameVisual),i(r,[{key:"initialize",value:function(){}},{key:"createObjects",value:function(){}},{key:"initializeUI",value:function(e){this.ui=e,this.inputs.launch(this.ui)}},{key:"addVisual",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new s.GameView;e.world=this,e.bind(t),this.visuals.push(e)}},{key:"raiseEvent",value:function(t,n){this.eventSystem.raiseEvent(t,n),this.visuals.forEach(function(e){e.eventSystem.raiseEvent(t,n)})}}]),r}();n.GameWorld=r},{"../../Common/Inputs":6,"../../Core/GeneralProcess":8,"../GameObject/GameView":15,"../GameObject/GameVisual":16}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GameWorldView=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../GameObject/GameView"),o=e("../../../Engine/UI/Color");var a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.isClear=!1,e.clearColor=o.Colors.Black,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GameView),r(t,[{key:"draw",value:function(e,t){this.isClear&&(t.fillStyle=this.clearColor.rgba,t.fillRect(0,0,this.target.width,this.target.height)),this.target.visuals.forEach(function(e){e.view&&e.view.render.process(t)})}}]),t}();n.GameWorldView=a},{"../../../Engine/UI/Color":24,"../GameObject/GameView":15}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.FileIO=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../Common/Exception");var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"openFileDialog",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=document.createElement("input");n.setAttribute("type","file"),n.setAttribute("accept",e),n.onchange=function(e){t&&t(e)},n.click()}},{key:"readAllText",value:function(e,t){this._readByFileReader(e,t,function(e,t){e.readAsText(t)})}},{key:"readAsDataURL",value:function(e,t){this._readByFileReader(e,t,function(e,t){e.readAsDataURL(t)})}},{key:"_readByFileReader",value:function(e,t,n){var r=new FileReader;n(r,e),r.onload=function(){t&&t(r.result)},r.onerror=function(){throw new i.Exception("Could not read file, error code:"+r.error.code)}}}]),e}();n.FileIO=o},{"../Common/Exception":5}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var i=function(){function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.M11=e,this.M12=t,this.M21=n,this.M22=r,this.M31=i,this.M32=o,this}return r(s,null,[{key:"createScale",value:function(e,t,n){var r=new s,i=n.x*(1-e),o=n.y*(1-t);return r.M11=e,r.M12=0,r.M21=0,r.M22=t,r.M31=i,r.M32=o,r}},{key:"createRotation",value:function(e,t){var n=new s,r=Math.cos(e),i=Math.sin(e),o=t.x*(1-r)+t.y*i,a=t.y*(1-r)-t.x*i;return n.M11=r,n.M12=i,n.M21=-i,n.M22=r,n.M31=o,n.M32=a,n}},{key:"createTranslation",value:function(e){var t=new s;return t.M11=1,t.M12=0,t.M21=0,t.M22=1,t.M31=e.x,t.M32=e.y,t}},{key:"Identity",get:function(){return new s}}]),r(s,[{key:"toArray",value:function(){return[this.M11,this.M12,this.M21,this.M22,this.M31,this.M32]}},{key:"toIdentity",value:function(){return this.M11=this.M22=1,this.M12=this.M21=this.M31=this.M32=0,this}},{key:"transform",value:function(e,t,n,r,i,o,a){var s=Math.cos(i),u=Math.sin(i);return this.append(s*n,u*n,-u*r,s*r,e,t),(o||a)&&(this.M31-=o*this.M11+a*this.M21,this.M32-=o*this.M12+a*this.M22),this}},{key:"append",value:function(e,t,n,r,i,o){var a=this.M11,s=this.M12,u=this.M21,c=this.M22;return this.M11=e*a+t*u,this.M12=e*s+t*c,this.M21=n*a+r*u,this.M22=n*s+r*c,this.M31=i*a+o*u+this.M31,this.M32=i*s+o*c+this.M32,this}},{key:"multiply",value:function(e){return this.append.apply(this,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e.toArray())),this}},{key:"invert",value:function(){var e=this.M11,t=this.M12,n=this.M21,r=this.M22,i=this.M31,o=e*r-t*n;return this.M11=r/o,this.M12=-t/o,this.M21=-n/o,this.M22=e/o,this.M31=(n*this.M32-r*i)/o,this.M32=-(e*this.M32-t*i)/o,this}},{key:"copy",value:function(e){return this.setValues(e.a,e.b,e.c,e.d,e.tx,e.ty)}}]),s}();n.Matrix3x2=i},{}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"next",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Number.MAX_SAFE_INTEGER;return Math.floor(0<=Math.random()*e?e:0)}},{key:"range",value:function(e,t){return Math.ceil(e+Math.floor(Math.random()*(t-e)))}},{key:"normal",value:function(e,t){for(var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:3,r=0,i=0;i<n;i++)r+=this.range(e,t+1);return r/n}},{key:"sample",value:function(){return Math.random()}}]),e}();n.Random=i},{}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Transform=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Numerics/Vector2"),o=e("./Matrix3x2");var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.translation=new i.Vector2(0,0),this.scale=new i.Vector2(1,1),this.rotation=0,this.center=new i.Vector2(0,0)}return r(e,[{key:"toMatrix3x2",value:function(){var e=o.Matrix3x2.createScale(this.scale.x,this.scale.y,this.center),t=o.Matrix3x2.createRotation(this.rotation,this.center),n=o.Matrix3x2.createTranslation(this.translation);return e.multiply(t).multiply(n)}}]),e}();n.Transform=a},{"../../Engine/Numerics/Vector2":23,"./Matrix3x2":20}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var r=function(){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.x=e,this.y=t}return i(r,[{key:"clone",value:function(){return new r(this.x,this.y)}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"sqrLength",value:function(){return this.x*this.x+this.y*this.y}},{key:"normalize",value:function(){var e=1/this.length();return new r(this.x*e,this.y*e)}},{key:"negate",value:function(){return new r(-this.x,-this.y)}},{key:"add",value:function(e){return new r(this.x+e.x,this.y+e.y)}},{key:"subtract",value:function(e){return new r(this.x-e.x,this.y-e.y)}},{key:"multiply",value:function(e){return new r(this.x*e,this.y*e)}},{key:"divide",value:function(e){var t=1/e;return new r(this.x*t,this.y*t)}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"rotate",value:function(e){var t=Math.sin(e),n=Math.cos(e);return new r(this.x*n-this.y*t,this.y*n+this.x*t)}},{key:"setLength",value:function(e){var t=this.length();0<t&&(this.x=this.x*e/t,this.y=this.y*e/t)}},{key:"limitLength",value:function(e){e<this.length()&&this.setLength(e)}},{key:"cos",value:function(e){return this.dot(e)/(this.length()*e.length())}}]),r}();n.Vector2=r},{}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:255,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:255,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:255,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;o(this,i),this.r=e,this.g=t,this.b=n,this.a=r}return r(i,[{key:"hex",get:function(){var e=Math.floor(this.r),t=Math.floor(this.g),n=Math.floor(this.b),r=e<16?"0":"",i=n<16?"0":"";return"#"+(t<16?"0":"")+e.toString(16)+r+t.toString(16)+i+n.toString(16)}},{key:"rgba",get:function(){return"rgba("+Math.floor(this.r)+","+Math.floor(this.g)+","+Math.floor(this.b)+","+this.a+")"}}],[{key:"fromHex",value:function(e){var t=parseInt(e.slice(1),16);return new i(t/65536,t/256%256,t%256)}}]),r(i,[{key:"clone",value:function(){return new i(this.r,this.g,this.b,this.a)}}]),i}(),i=function(){function e(){o(this,e)}return r(e,null,[{key:"gradient",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=e.r;n+=t,n=Math.min(255,Math.max(0,n));var r=e.g;r+=t,r=Math.min(255,Math.max(0,r));var i=e.b;return i+=t,i=Math.min(255,Math.max(0,i)),new a(n,r,i,e.a)}},{key:"gradientRandom",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=t/2,r=e.r;r+=Math.random()*t-n,r=Math.min(255,Math.max(0,r));var i=e.g;i+=Math.random()*t-n,i=Math.min(255,Math.max(0,i));var o=e.b;return o+=Math.random()*t-n,o=Math.min(255,Math.max(0,o)),new a(r,i,o,e.a)}}]),e}(),s=function(){function e(){o(this,e)}return r(e,null,[{key:"Black",get:function(){return new a(0,0,0,1)}},{key:"White",get:function(){return new a(255,255,255,1)}},{key:"Random",get:function(){return new a(255*Math.random(),255*Math.random(),255*Math.random(),1)}}]),e}();n.Color=a,n.ColorHelper=i,n.Colors=s},{}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var i=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,null,[{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";t.onchange&&t.onchange(e)}}]),t}();i.onchange=function(e){window.alert(e)},n.MessageBox=i},{}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.EventHelper=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Numerics/Vector2");var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"getEventClientPositon",value:function(e){return e instanceof MouseEvent?new i.Vector2(e.clientX,e.clientY):e instanceof TouchEvent?new i.Vector2(e.changedTouches[0].clientX,e.changedTouches[0].clientY):null}}]),e}();n.EventHelper=o},{"../../Engine/Numerics/Vector2":23}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GalleryStarter=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../Engine/Game/Animation/AnimationBox"),o=e("./Visuals/ParticlesFlyerWorld"),a=e("./Visuals/ParticlesWalkerWorld"),s=e("./Visuals/ParticlesTreeWorld"),u=e("./Visuals/LSystemTreeWorld"),c=e("./Visuals/GameOfLifeWorld"),l=e("./Visuals/AudioVisualizerWorld"),f=e("./Games/EndlessAbyssWorld");var h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.symbols={},this.addSymbol("flyer",o.ParticlesFlyerWorld),this.addSymbol("walker",a.ParticlesWalkerWorld),this.addSymbol("tree",s.ParticlesTreeWorld),this.addSymbol("lsystemtree",u.LSystemTreeWorld),this.addSymbol("gameoflife",c.GameOfLifeWorld),this.addSymbol("audiovisualizer",l.AudioVisualizerWorld),this.addSymbol("endlessabyss",f.EndlessAbyssWorld)}return r(e,[{key:"addSymbol",value:function(e,t){this.symbols[e]=t}},{key:"getSymbolByName",value:function(e){return this.symbols[e]}},{key:"launch",value:function(e){var t=this._getRequest(),n=this.getSymbolByName(t.scene);if(n)return document.title=n.Title,new i.AnimationBox(e,new n(e.width,e.height));window.location="../"}},{key:"_getRequest",value:function(){var e={},t=location.search;if(0<=t.indexOf("?"))for(var n=t.substr(1).split("&"),r=0;r<n.length;r++)e[n[r].split("=")[0]]=unescape(n[r].split("=")[1]);return e}}]),e}();n.GalleryStarter=h},{"../Engine/Game/Animation/AnimationBox":12,"./Games/EndlessAbyssWorld":33,"./Visuals/AudioVisualizerWorld":35,"./Visuals/GameOfLifeWorld":39,"./Visuals/LSystemTreeWorld":45,"./Visuals/ParticlesFlyerWorld":56,"./Visuals/ParticlesTreeWorld":57,"./Visuals/ParticlesWalkerWorld":58}],28:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.EndlessAbyssView=n.EndlessAbyss=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../Engine/Game/GameObject/GameVisual"),o=e("../../../Engine/Numerics/Vector2"),a=e("../../../Engine/UI/Color"),s=e("../../../Engine/Utilities/EventHelper"),u=e("../../../Engine/Game/GameObject/GameView"),c=e("./Models/BlockGrid"),l=e("../../../Engine/Game/GameComponents/Effect/Effect"),f=e("../../../Engine/Common/DelayTimer"),h=e("../../../Engine/Drawing/Graphics"),p=e("../../../Engine/Drawing/OffscreenCanvas");function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var m=function(e){function n(e){d(this,n);var t=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.start.next(t._start),t.update.next(t._update),t.width=10,t.blockGrid=new c.BlockGrid(t.width,20),t.timer=new f.DelayTimer,t.ghost=new l.GhostEffect(new a.Color(0,0,0,.01),40,!1),t.proxy(t.ghost),t}return v(n,i.GameVisual),r(n,[{key:"_start",value:function(){var e=this.world.width,t=this.world.height;this.settings={rotation:0,center:new o.Vector2(e/2,t/2),playing:!1,gameover:!1,progress:0,delayTime:500,pointer:{position:new o.Vector2,rotation:0,count:0}},this._registEvents()}},{key:"_update",value:function(){var t=this;this.settings.playing&&this.timer.delay(this.settings.delayTime,function(){t.blockGrid.down(),t.settings.progress=0},function(e){t.settings.progress=e/t.settings.delayTime}),this.settings.rotation+=.002}},{key:"_registEvents",value:function(){var o=this;this.on("KeyPress",function(e){o.settings.playing?"a"===e.key?o.blockGrid.left():"d"===e.key?o.blockGrid.right():"w"===e.key?o.blockGrid.up():"s"===e.key&&o.blockGrid.down():"Enter"===e.key&&(o.settings.playing=!0,o.settings.gameover&&(o.settings.gameover=!1,o.blockGrid=new c.BlockGrid(o.width,20)))}),this.on("PointerPressed",function(e){var t=o.settings.pointer;t.position=s.EventHelper.getEventClientPositon(e),t.rotation=o.settings.rotation,t.count=0}),this.on("PointerMoved",function(e){if(o.world.inputs.pointer.isPressed){var t=o.settings.pointer,n=s.EventHelper.getEventClientPositon(e).subtract(t.position),r=t.position.subtract(o.settings.center).rotate(Math.PI/2).normalize(),i=n.dot(r)/100;o.settings.rotation=t.rotation+i,t.count+=1,8<t.count&&(t.position=s.EventHelper.getEventClientPositon(e),t.rotation=o.settings.rotation,t.count=0)}}),this.blockGrid.onover=function(){o.settings.playing=!1,o.settings.gameover=!0}}}]),n}(),g=function(e){function t(){d(this,t);var e=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.single=0,e.fill={white:new a.Color(255,255,255,.05),blank:new a.Color(255,255,255,.05),mask:new a.Color(0,0,0,.6)},e.stroke={white:new a.Color(255,255,255,.05),black:new a.Color(0,0,0,.2)},e}return v(t,u.GameView),r(t,[{key:"draw",value:function(e,t){var n=this;this.innerCanvas||(this.innerCanvas=new p.OffscreenCanvas(t.canvas.width,t.canvas.height));var r=this.target.world.width,i=this.target.world.height,o=r/2,a=i/2;this.innerCanvas.draw(function(e){n.drawDynamic(e,r,i,o,a)}).output(t,0,0),this.drawStatic(t,r,i,o,a)}},{key:"drawDynamic",value:function(e,t,n,r,i){this.target.ghost.effect(e),h.Graphics.offsetScale(e,8,8*e.canvas.height/e.canvas.width,.99),this.drawAll(e,t,n,r,i)}},{key:"drawStatic",value:function(e,t,n,r,i){this.target.settings.playing?this.drawAll(e,t,n,r,i,!1):(this.drawMask(e,t,n),this.target.settings.gameover?this.drawTitle(e,t,n,r,i,"Game Over"):this.drawTitle(e,t,n,r,i,"Endless Abyss"),this.drawNotify(e,t,n,r,i))}},{key:"drawMask",value:function(e,t,n){e.fillStyle=this.fill.mask.rgba,e.fillRect(0,0,t,n)}},{key:"drawTitle",value:function(e,t,n,r,i,o){var a=Math.max(t/20,48);e.font=a+"px Arial",e.textAlign="center",e.fillStyle="#FFF",e.fillText(o,r,i)}},{key:"drawNotify",value:function(e,t,n,r,i){var o=Math.max(t/48,32);e.font=o+"px Arial",e.textAlign="center",this.single+=.06,e.fillStyle=new a.Color(255,255,255,.6+.4*Math.sin(this.single)).rgba,e.fillText("Press enter key to start",r,i+1.6*o)}},{key:"drawAll",value:function(e,t,n,r,i){var o=!(5<arguments.length&&void 0!==arguments[5])||arguments[5],a=this.target.blockGrid.width,s=this.target.blockGrid.height,u=(.8*Math.min(t,n)-100)/s/2+0,c=1-this.target.settings.progress,l=this.target.blockGrid.allBlocks,f=this.target.blockGrid.preBlocks,h=this.target.blockGrid,p=this.target.blockGrid.current.getBlocks(),d=this.target.blockGrid.next.getBlocks(),y=this.stroke.white,v=this.fill.white;o?(this.drawBlocks(e,l,r,i,50,u,0,0,a,y,null),this.drawBlocks(e,h,r,i,50,u,0,0,a,y,v,!1,!0),this.drawBlocks(e,f,r,i,50,u,0,0,a,null,this.fill.blank),this.drawBlocks(e,d,r,i,50,u,0,4,a,null,null,!0,!0)):(y=this.stroke.black,this.drawBlocks(e,h,r,i,50,u,0,0,a,y,null),this.drawBlocks(e,p,r,i,50,u,0,c,a,y,null,!1,!0))}},{key:"drawBlocks",value:function(u,e,c,l,f,h,t,p,n,d,y,v,m){var g=this,b=Math.PI/n,w=h-t;e.forEach(function(e){if(e){var t=e.location.x,n=e.location.y+p,r=t*b*2,i=r-b+g.target.settings.rotation,o=r+b+g.target.settings.rotation,a=v?e.color:d,s=m?e.color:y;g.drawSingle(u,c,l,f+n*h,w,i,o,a,s)}})}},{key:"drawSingle",value:function(e,t,n,r,i,o,a,s,u){e.beginPath(),e.arc(t,n,r,o,a,!1),e.arc(t,n,r+i,a,o,!0),e.closePath(),s&&(e.strokeStyle=s.rgba,e.stroke()),u&&(e.fillStyle=u.rgba,e.fill())}}]),t}();n.EndlessAbyss=m,n.EndlessAbyssView=g},{"../../../Engine/Common/DelayTimer":2,"../../../Engine/Drawing/Graphics":10,"../../../Engine/Drawing/OffscreenCanvas":11,"../../../Engine/Game/GameComponents/Effect/Effect":14,"../../../Engine/Game/GameObject/GameView":15,"../../../Engine/Game/GameObject/GameVisual":16,"../../../Engine/Numerics/Vector2":23,"../../../Engine/UI/Color":24,"../../../Engine/Utilities/EventHelper":26,"./Models/BlockGrid":30}],29:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Block=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../../../Engine/Numerics/Vector2"),o=e("../../../../../Engine/UI/Color");var a=function(){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.location=new i.Vector2(e,t),this.color=o.Colors.White}return r(n,[{key:"setLocation",value:function(e){return this.location=e,this}},{key:"setColor",value:function(e){return this.color=e,this}}]),n}();n.Block=a},{"../../../../../Engine/Numerics/Vector2":23,"../../../../../Engine/UI/Color":24}],30:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BlockGrid=void 0;var i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("../../../../Engine/Collections/Array2"),s=e("../../../../Engine/Numerics/Vector2"),a=e("../../../../Engine/UI/Color"),u=e("./BlockGroup"),c=e("./Block/Block");var r=function(e){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t));n.current=null,n.next=null,n.upOffset=new s.Vector2(0,0),n.downOffset=new s.Vector2(0,-1),n.leftOffset=new s.Vector2(-1,0),n.rightOffset=new s.Vector2(1,0),n.indexOffset=1;return n.colors=["#8F1D78","#BA874C","#E9AE6A"].map(function(e){return a.Color.fromHex(e)}),n.blockGroups=u.BlockGroupHelper.getStandardGroups(),n._generateNext(),n._generateCurrent(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,o.Array2),i(r,[{key:"allBlocks",get:function(){return this._allBlocks}},{key:"preBlocks",get:function(){return this._preBlocks}}]),i(r,[{key:"up",value:function(){this._checkMoveAvaliable(this.current,this.upOffset,this.indexOffset)&&this.current.move(this.upOffset).rotate(this.indexOffset)}},{key:"down",value:function(){this._checkMoveAvaliable(this.current,this.downOffset)?this.current.move(this.downOffset):this.current.location.y===this.height-1?this.over():(this._combineBlock(this.current),this._generateCurrent())}},{key:"left",value:function(){this._checkMoveAvaliable(this.current,this.leftOffset)&&this.current.move(this.leftOffset)}},{key:"right",value:function(){this._checkMoveAvaliable(this.current,this.rightOffset)&&this.current.move(this.rightOffset)}},{key:"over",value:function(){this.onover&&this.onover()}},{key:"setCurrent",value:function(e){this.current=e}},{key:"_generateCurrent",value:function(){this.current=this.next,this._generateNext(),this._generateInformation()}},{key:"_generateNext",value:function(){var e=Math.floor(Math.random()*this.blockGroups.length),t=new s.Vector2(Math.floor(this.width*Math.random()),this.height-1),n=Math.floor(4*Math.random()),r=this.colors[Math.floor(this.colors.length*Math.random())];this.next=this.blockGroups[e].clone().setLocation(t).setColor(r).rotate(n)}},{key:"_generateInformation",value:function(){var r=this;this._allBlocks=[],this._preBlocks=[];var i=this._findMaxRow();this.forEach(function(e,t,n){r._allBlocks.push(e||new c.Block(t,n)),!e&&n<=i&&r._preBlocks.push(new c.Block(t,n))})}},{key:"_checkMoveAvaliable",value:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:s.Vector2.Zero(),n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],i=this.current.getLocations(n),o=0;o<i.length;o++){var a=i[o].add(t);if(r&&(a.x=a.x%this.width,a.x<0&&(a.x+=this.width)),a.y<0||this.get(a.x,a.y))return!1}return!0}},{key:"_combineBlock",value:function(e){var t=this,n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];e.getBlocks().forEach(function(e){e&&(n&&(e.location.x=e.location.x%t.width,e.location.x<0&&(e.location.x+=t.width)),t.set(e.location.x,e.location.y,e))}),this._combineFullRow()}},{key:"_combineFullRow",value:function(){for(var e=this._findMaxRow(),t=!1,n=0;n<e;n++)this._checkFullRow(n)&&(this._clearSingleRow(n),t=!0);t&&this._updateBlockLocation()}},{key:"_findMaxRow",value:function(){for(var e=-1,t=0;t<this.height;t++)for(var n=0;n<this.width;n++)if(this.get(n,t)){e=t;break}return e}},{key:"_clearSingleRow",value:function(e){for(var t=0;t<this.width;t++)this.data[t].splice(e,1),this.data[t].push(null)}},{key:"_checkFullRow",value:function(e){for(var t=0;t<this.width;t++)if(!this.get(t,e))return!1;return!0}},{key:"_updateBlockLocation",value:function(){this.forEach(function(e,t,n){e&&e.setLocation(new s.Vector2(t,n))})}}]),r}();n.BlockGrid=r},{"../../../../Engine/Collections/Array2":1,"../../../../Engine/Numerics/Vector2":23,"../../../../Engine/UI/Color":24,"./Block/Block":29,"./BlockGroup":31}],31:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BlockGroupHelper=n.BlockGroup=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("./OffsetMap/OffsetMap"),o=e("./Block/Block"),a=e("../../../../Engine/Numerics/Vector2"),s=e("../../../../Engine/UI/Color");function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c=function(){function t(){u(this,t),this.location=new a.Vector2(0,0),this.color=s.Colors.White,this.offsetMaps=[],this.currentIndex=0}return r(t,[{key:"clone",value:function(){var e=new t;return e.location=this.location.clone(),e.color=this.color,e.offsetMaps=this.offsetMaps,e.currentIndex=this.currentIndex,e}},{key:"setLocation",value:function(e){return this.location=e,this}},{key:"setColor",value:function(e){return this.color=e,this}},{key:"addOffsetMap",value:function(e){return this.offsetMaps.push(e),this}},{key:"addOffsetMapRange",value:function(e){var t=this;return e.forEach(function(e){t.offsetMaps.push(e)}),this}},{key:"getLocations",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=(this.currentIndex+e)%this.offsetMaps.length;return this.offsetMaps[t].getLocations(this.location)}},{key:"getBlocks",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=[];return this.getLocations(e).forEach(function(e){n.push((new o.Block).setLocation(e).setColor(t.color.clone()))}),n}},{key:"move",value:function(e){return this.location=this.location.add(e),this}},{key:"rotate",value:function(){return this.currentIndex=(this.currentIndex+1)%this.offsetMaps.length,this}}]),t}(),l=function(){function e(){u(this,e)}return r(e,null,[{key:"getStandardGroups",value:function(){return[[{x:[0,0,0,0],y:[0,-1,-2,-3]},{x:[0,1,2,3],y:[0,0,0,0]}],[{x:[1,1,1,0],y:[0,-1,-2,-2]},{x:[0,0,1,2],y:[,-1,-1,-1]},{x:[0,1,0,0],y:[0,0,-1,-2]},{x:[0,1,2,2],y:[0,0,0,-1]}],[{x:[0,0,0,1],y:[0,-1,-2,-2]},{x:[0,1,2,0],y:[0,0,0,-1]},{x:[0,1,1,1],y:[0,0,-1,-2]},{x:[2,0,1,2],y:[0,-1,-1,-1]}],[{x:[0,1,0,1],y:[0,0,-1,-1]}],[{x:[1,2,0,1],y:[0,0,-1,-1]},{x:[0,0,1,1],y:[0,-1,-1,-2]}],[{x:[0,1,1,2],y:[0,0,-1,-1]},{x:[1,1,0,0],y:[0,-1,-1,-2]}],[{x:[0,1,2,1],y:[0,0,0,-1]},{x:[1,0,1,1],y:[0,-1,-1,-2]},{x:[1,0,1,2],y:[0,-1,-1,-1]},{x:[0,0,1,0],y:[0,-1,-1,-2]}]].map(function(e){return(new c).addOffsetMapRange(e.map(function(n){return new i.OffsetMap(n.x.map(function(e,t){return new a.Vector2(n.x[t],n.y[t])}))}))})}}]),e}();n.BlockGroup=c,n.BlockGroupHelper=l},{"../../../../Engine/Numerics/Vector2":23,"../../../../Engine/UI/Color":24,"./Block/Block":29,"./OffsetMap/OffsetMap":32}],32:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var i=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.offsets=e}return r(t,[{key:"setOffsets",value:function(e){return this.offsets=e,this}},{key:"getLocations",value:function(t){var n=[];return this.offsets.forEach(function(e){n.push(t.add(e))}),n}}]),t}();n.OffsetMap=i},{}],33:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.EndlessAbyssWorld=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Game/GameWorld/GameWorld"),o=e("../../Engine/Game/GameWorld/GameWorldView"),a=e("../../Engine/Common/Inputs"),s=e("./EndlessAbyss/EndlessAbyss");var u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GameWorld),r(t,[{key:"initialize",value:function(){this.bind(new o.GameWorldView),this.inputs.addInput(new a.PointerInput),this.inputs.addInput(new a.KeyInput)}},{key:"createObjects",value:function(){this.addVisual(new s.EndlessAbyss,new s.EndlessAbyssView)}}],[{key:"Title",get:function(){return"Game - EndlessAbyss"}}]),t}();n.EndlessAbyssWorld=u},{"../../Engine/Common/Inputs":6,"../../Engine/Game/GameWorld/GameWorld":17,"../../Engine/Game/GameWorld/GameWorldView":18,"./EndlessAbyss/EndlessAbyss":28}],34:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AudioVisualizerView=n.AudioVisualizer=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../Engine/Game/GameObject/GameVisual"),o=e("../../../Engine/Common/DelayTimer"),a=e("../../../Engine/IO/FileIO"),s=e("../../../Engine/Game/GameComponents/Effect/Effect"),u=e("../../../Engine/UI/Color"),c=e("../../../Engine/UI/MessageBox"),l=e("../../../Engine/Game/GameObject/GameView"),f=e("../../../Engine/Drawing/Graphics"),h=e("../../../Engine/Drawing/OffscreenCanvas");function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=function(e){function n(){p(this,n);var t=d(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.timer=new o.DelayTimer,t.start.next(function(){t.initAudio(),t.on("Drop",function(e){t.loadFile(e.dataTransfer.files[0])}),t.on("PointerClicked",function(){a.FileIO.openFileDialog(function(e){t.loadFile(e.target.files[0])},"audio/*")})}),t.dispose.next(function(){t.audioContext.close(),t.audio&&t.audio.remove()}),t.ghost=new s.GhostEffect(new u.Color(0,0,0,.01),40,!1),t.proxy(t.ghost),t}return y(n,i.GameVisual),r(n,[{key:"FFTData",get:function(){return this.audioAnalyzer.getByteFrequencyData(this.freqByteData),this.freqByteData}}]),r(n,[{key:"initAudio",value:function(){this.audioContext=new AudioContext,this.audio=document.createElement("audio"),this.audio.loop=!0,document.body.appendChild(this.audio),this.audioSource=this.audioContext.createMediaElementSource(this.audio),this.audioAnalyzer=this.audioContext.createAnalyser(),this.fftSize=1200<this.world.width?2048:1024,this.audioAnalyzer.fftSize=this.fftSize,this.freqByteData=new Uint8Array(this.audioAnalyzer.frequencyBinCount),this.audioSource.connect(this.audioAnalyzer),this.audioAnalyzer.connect(this.audioContext.destination),this.file={name:"",playing:!1}}},{key:"loadFile",value:function(e){e&&0===e.type.indexOf("audio")?(this.audio.src=URL.createObjectURL(e),this.audio.autoplay=!0,this.audio.play(),this.file.playing=!0,this.file.name=e.name.split(".").shift()):c.MessageBox.show("Please select a valid audio file.")}}]),n}(),m=function(e){function t(){p(this,t);var e=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.rotation=0,e.rotation2=0,e}return y(t,l.GameView),r(t,[{key:"draw",value:function(e,t){this.innerCanvas||(this.innerCanvas=new h.OffscreenCanvas(t.canvas.width,t.canvas.height)),this.drawDynamic(this.innerCanvas.context),this.innerCanvas.output(t,0,0),this.drawStatic(t)}},{key:"drawDynamic",value:function(e){var t=this,n=this.target.world.width,r=this.target.world.height,i=n/2,o=r/2;this.target.ghost.effect(e),this.target.file.playing?(this.rotation+=.001,f.Graphics.offsetScale(e,5,5,.99),f.Graphics.rotate(e,this.rotation,1,function(){t.drawFFT(e,n,r,i,o)}),f.Graphics.rotate(e,Math.PI,1,function(){e.drawImage(e.canvas,0,0,n,r)})):(this.drawText(e,n,r,i,o),f.Graphics.mirror(e,1,-1,.01,function(){e.drawImage(e.canvas,0,0)}))}},{key:"drawText",value:function(e,t,n,r,i){var o=Math.max(t/30,32);e.font=o+"px Arial",e.textAlign="center",e.fillStyle="#FFF",e.fillText("Drag an audio file here.",r,i-o/2.5),e.fillRect(0,i-2,t,4)}},{key:"drawFFT",value:function(e,t,n,r,i){var o=this.target.FFTData;e.beginPath(),this.rotation2+=.002;for(var a=0;a<o.length;a++){var s=o[a],u=a/o.length*t,c=i+s+100*Math.sin(u/(100+50*Math.sin(this.rotation2)));e.lineTo(u,c)}e.lineWidth=t/o.length,e.strokeStyle="#FFF",e.stroke()}},{key:"drawStatic",value:function(e){var t=this.target.world.width,n=this.target.world.height;this.drawFileinfo(e,t,n)}},{key:"drawFileinfo",value:function(e,t,n){var r=this.target.file;if(r.playing){var i=Math.max(t/48,16),o=.1*t,a=.8*n;e.font=i+"px Arial",e.textAlign="left",e.fillStyle="#FFF",e.fillText(r.name,o,a);var s=.8*t,u=this.target.audio.currentTime/this.target.audio.duration;e.strokeStyle="#FFF",e.strokeRect(o,a+i,s,i/3),e.fillRect(o,a+i,s*u,i/3)}}}]),t}();n.AudioVisualizer=v,n.AudioVisualizerView=m},{"../../../Engine/Common/DelayTimer":2,"../../../Engine/Drawing/Graphics":10,"../../../Engine/Drawing/OffscreenCanvas":11,"../../../Engine/Game/GameComponents/Effect/Effect":14,"../../../Engine/Game/GameObject/GameView":15,"../../../Engine/Game/GameObject/GameVisual":16,"../../../Engine/IO/FileIO":19,"../../../Engine/UI/Color":24,"../../../Engine/UI/MessageBox":25}],35:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AudioVisualizerWorld=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Game/GameWorld/GameWorld"),o=e("../../Engine/Game/GameWorld/GameWorldView"),a=e("../../Engine/Common/Inputs"),s=e("./AudioVisualizer/AudioVisualizer");var u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GameWorld),r(t,[{key:"initialize",value:function(){this.bind(new o.GameWorldView),this.inputs.addInput(new a.PointerInput),this.inputs.addInput(new a.DragDropInput)}},{key:"createObjects",value:function(){this.addVisual(new s.AudioVisualizer,new s.AudioVisualizerView)}}],[{key:"Title",get:function(){return"Audio - Visualizer"}}]),t}();n.AudioVisualizerWorld=u},{"../../Engine/Common/Inputs":6,"../../Engine/Game/GameWorld/GameWorld":17,"../../Engine/Game/GameWorld/GameWorldView":18,"./AudioVisualizer/AudioVisualizer":34}],36:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Cell=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../Engine/Numerics/Vector2"),o=e("../../../Engine/UI/Color");var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.location=new i.Vector2(0,0),this.color=o.Colors.Black,this.size=1}return r(e,[{key:"setLocation",value:function(e){return this.location=e,this}},{key:"setColor",value:function(e){return this.color=e,this}},{key:"setSize",value:function(e){return this.size=e,this}}]),e}();n.Cell=a},{"../../../Engine/Numerics/Vector2":23,"../../../Engine/UI/Color":24}],37:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CellularAutomata=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),f=e("../../../Engine/UI/Color"),i=e("../../../Engine/Collections/Array2");var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Array2),r(t,[{key:"generate",value:function(){return new t(this.width,this.height)}},{key:"around",value:function(e,t,n,r){for(var i=0,o=0;o<8;o++){var a=e+n[o],s=t+r[o];this.data[a]&&this.data[a][s]&&(i+=1)}return i}},{key:"aroundColor",value:function(e,t,n,r){for(var i=0,o=0,a=0,s=0,u=0;u<8;u++){var c=e+n[u],l=t+r[u];this.data[c]&&this.data[c][l]&&(i+=this.data[c][l].color.r,o+=this.data[c][l].color.g,a+=this.data[c][l].color.b,s+=1)}return new f.Color(i/s,o/s,a/s)}}]),t}();n.CellularAutomata=o},{"../../../Engine/Collections/Array2":1,"../../../Engine/UI/Color":24}],38:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GameOfLifeView=n.GameOfLife=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../../Engine/Game/GameObject/GameVisual"),o=e("../../../../Engine/Game/GameComponents/Effect/Effect"),u=e("../../../../Engine/UI/Color"),a=e("../CellularAutomata"),s=e("../../../../Engine/Numerics/Vector2"),c=e("../Cell"),l=e("../../../../Engine/Game/GameObject/GameView"),f=e("../../../../Engine/Drawing/Graphics"),h=e("../../../../Engine/Common/DelayTimer");function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=function(e){function n(e){p(this,n);var t=d(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.start.next(t._start),t.update.next(t._update),t.timer=new h.DelayTimer,t.xOffsets=[-1,0,1,1,1,0,-1,-1],t.yOffsets=[-1,-1,-1,0,1,1,1,0],t.createColor=new u.Color(128,128,128,1),t.proxy(new o.GhostEffect(new u.Color(0,0,0,.05),0)),t}return y(n,i.GameVisual),r(n,[{key:"_start",value:function(){var r=this;this.cellSize=16;var e=this.world.width,t=this.world.height,n=Math.round(e/this.cellSize),i=Math.round(t/this.cellSize);this.CA=new a.CellularAutomata(n,i),this.CA.forEach(function(e,t,n){.9<Math.random()&&r._addDefaultCell(r.CA,t,n)}),this._bindEvents()}},{key:"_update",value:function(){var e=this;this.timer.delay(500,function(){e._generate()})}},{key:"_bindEvents",value:function(){var s=this;this.on("PointerMoved",function(){if(s.world.inputs.pointer.isPressed){s.createColor=u.ColorHelper.gradientRandom(s.createColor,20);for(var e=s.world.inputs.pointer.position,t=Math.round(e.x/s.cellSize),n=Math.round(e.y/s.cellSize),r=0;r<4;r++){var i=t+Math.round(2*Math.random()-1),o=n+Math.round(2*Math.random()-1),a=u.ColorHelper.gradientRandom(s.createColor,10);s._addDefaultCell(s.CA,i,o,a)}}})}},{key:"_generate",value:function(){var a=this,s=this.CA.generate();this.CA.forEach(function(e,t,n){var r=a.CA.around(t,n,a.xOffsets,a.yOffsets);if(e){if(2===r||3===r||4===r){var i=a.CA.get(t,n);s.set(t,n,i)}}else if(3===r){var o=a.CA.aroundColor(t,n,a.xOffsets,a.yOffsets);a._addDefaultCell(s,t,n,o)}}),this.CA=s}},{key:"_addDefaultCell",value:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:u.Colors.Random,i=new s.Vector2(t*this.cellSize,n*this.cellSize);e.set(t,n,new c.Cell).setLocation(i).setColor(r).setSize(this.cellSize)}}]),n}(),m=function(e){function t(){return p(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,l.GameView),r(t,[{key:"draw",value:function(e,n){f.Graphics.offsetScale(n,-6,-6,.99),this.target.CA.forEach(function(e){if(e){var t=e.location;n.fillStyle=e.color.rgba,n.fillRect(t.x,t.y,e.size,e.size)}})}}]),t}();n.GameOfLife=v,n.GameOfLifeView=m},{"../../../../Engine/Common/DelayTimer":2,"../../../../Engine/Drawing/Graphics":10,"../../../../Engine/Game/GameComponents/Effect/Effect":14,"../../../../Engine/Game/GameObject/GameView":15,"../../../../Engine/Game/GameObject/GameVisual":16,"../../../../Engine/Numerics/Vector2":23,"../../../../Engine/UI/Color":24,"../Cell":36,"../CellularAutomata":37}],39:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GameOfLifeWorld=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Game/GameWorld/GameWorld"),o=e("../../Engine/Game/GameWorld/GameWorldView"),a=e("../../Engine/Common/Inputs"),s=e("./CA/GameOfLife/GameOfLife");var u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GameWorld),r(t,[{key:"initialize",value:function(){this.bind(new o.GameWorldView),this.inputs.addInput(new a.PointerInput)}},{key:"createObjects",value:function(){this.addVisual(new s.GameOfLife,new s.GameOfLifeView)}}],[{key:"Title",get:function(){return"CA - GameOfLife"}}]),t}();n.GameOfLifeWorld=u},{"../../Engine/Common/Inputs":6,"../../Engine/Game/GameWorld/GameWorld":17,"../../Engine/Game/GameWorld/GameWorldView":18,"./CA/GameOfLife/GameOfLife":38}],40:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LSystem=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("./Rule/RuleSet"),o=e("./State/State");var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.states=[],this.ruleSets={},this.root={}}return r(e,[{key:"initRoot",value:function(e){this.root=e,this.states=[],this.states.push(e)}},{key:"addRule",value:function(e){this.ruleSets[e.target]||(this.ruleSets[e.target]=new i.RuleSet),this.ruleSets[e.target].add(e)}},{key:"generate",value:function(){for(var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=function(e){var t=[];n.states.forEach(function(e){n.ruleSets[e.id]?e.children=n.ruleSets[e.id].rules[0].generate(e):e.children=n._getDefaultState(e),n._combineArray(t,e.children)}),n.states=[],n._combineArray(n.states,t)},r=0;r<e;r++)t()}},{key:"_getDefaultState",value:function(e){var t=[];return t.push(new o.State(e.id,e,e.generation+1)),t}},{key:"_combineArray",value:function(t,e){e.forEach(function(e){t.push(e)})}}]),e}();n.LSystem=a},{"./Rule/RuleSet":43,"./State/State":44}],41:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LSystemTreeView=n.LSystemTree=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../Engine/Game/GameObject/GameVisual"),o=e("./State/State"),a=e("./LSystem"),s=e("./Rule/RuleBase"),u=e("../../../Engine/Game/GameObject/GameView"),c=e("../../../Engine/UI/Color"),l=e("../../../Engine/Numerics/Vector2");function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var d=function(e){function n(e){f(this,n);var t=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));t.LSystem=new a.LSystem,t.LSystem.initRoot(new o.State("F",null,0));return t.LSystem.addRule(new s.RuleGrammar("F",0,"F[+F-F+F+FF]F[-F+F-F-FF]F")),t.depth=3,t.LSystem.generate(t.depth),t}return p(n,i.GameVisual),r(n,[{key:"states",get:function(){return this.LSystem.states}}]),n}(),y=function(e){function t(){f(this,t);var e=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.centerStack=[],e.offsetStack=[],e.lengthStack=[],e.currentIndex=0,e.singleNumber=0,e.rotateRatio=6,e.lineColor=new c.Color(255,255,255,1),e.animation=!0,e}return p(t,u.GameView),r(t,[{key:"draw",value:function(e,t){this.animation&&(this.singleNumber=(this.singleNumber+.1*Math.random())%(2*Math.PI),this.rotateRatio=6.2+.3*Math.sin(this.singleNumber),this.centerStack=[],this.offsetStack=[],this.lengthStack=[],this.currentIndex=0,this.lineColor=new c.Color(255,255,255,1),t.clearRect(0,0,this.target.world.width,this.target.world.height)),!this.animation&&this.center||(this.center=new l.Vector2(this.target.world.width/2,.9*this.target.world.height),this.lengthOfLine=this.target.world.height*(1/Math.pow(3,this.target.depth+1))*1,this.offset=new l.Vector2(0,-this.lengthOfLine));for(var n=0,r=this.animation?1e4:1e3,i=this.target.states,o=this.currentIndex;o<i.length&&(this.mapped(i[o].id,t),this.currentIndex=o+1,!(r<(n+=1)));o++);}},{key:"mapped",value:function(e,t){switch(e){case"F":this.drawLineBranch(t,this.center,this.offset),this.center=this.center.add(this.offset);break;case"M":this.center=this.center.add(this.offset);break;case"+":this.offset=this.offset.rotate(Math.PI/this.rotateRatio);break;case"-":this.offset=this.offset.rotate(-Math.PI/this.rotateRatio);break;case".":this.lengthOfLine*=.618,this.offset.setLength(this.lengthOfLine);break;case"*":this.lengthOfLine/=.618,this.offset.setLength(this.lengthOfLine);break;case"[":this.centerStack.push(this.center.clone()),this.offsetStack.push(this.offset.clone()),this.lengthStack.push(this.lengthOfLine);break;case"]":this.center=this.centerStack.pop(),this.offset=this.offsetStack.pop(),this.lengthOfLine=this.lengthStack.pop()}}},{key:"drawLineBranch",value:function(e,t,n){var r=t.add(n);e.strokeStyle=this.lineColor.rgba,e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(r.x,r.y),e.closePath(),e.stroke()}},{key:"drawCircleBranch",value:function(e,t,n){var r=t.add(n.multiply(.5));e.beginPath(),e.arc(r.x,r.y,n.length()/2,0,2*Math.PI,!1),e.closePath(),e.fillStyle=this.lineColor.rgba,e.fill()}}]),t}();n.LSystemTree=d,n.LSystemTreeView=y},{"../../../Engine/Game/GameObject/GameView":15,"../../../Engine/Game/GameObject/GameVisual":16,"../../../Engine/Numerics/Vector2":23,"../../../Engine/UI/Color":24,"./LSystem":40,"./Rule/RuleBase":42,"./State/State":44}],42:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.RuleGrammar=n.RuleBase=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("../State/State");function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function e(t,n){a(this,e),this.target=t,this.priority=n},i=function(e){function i(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";a(this,i);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t));return r.states=n.split(""),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,s),r(i,[{key:"generate",value:function(t){var n=[];return this.states.forEach(function(e){n.push(new o.State(e,t,t.generation+1))}),n}}]),i}();n.RuleBase=s,n.RuleGrammar=i},{"../State/State":44}],43:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rules=[]}return r(e,[{key:"add",value:function(e){this.rules.push(e),this.rules.sort(function(e,t){return e.priority-t.priority})}}]),e}();n.RuleSet=i},{}],44:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.State=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.parent=n,this.children=[],this.generation=r}},{}],45:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LSystemTreeWorld=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Game/GameWorld/GameWorld"),o=e("../../Engine/Game/GameWorld/GameWorldView"),a=e("./LSystem/LSystemTree");var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GameWorld),r(t,[{key:"initialize",value:function(){this.bind(new o.GameWorldView)}},{key:"createObjects",value:function(){this.addVisual(new a.LSystemTree,new a.LSystemTreeView)}}],[{key:"Title",get:function(){return"L-System - Tree"}}]),t}();n.LSystemTreeWorld=s},{"../../Engine/Game/GameWorld/GameWorld":17,"../../Engine/Game/GameWorld/GameWorldView":18,"./LSystem/LSystemTree":41}],46:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ArrayGrid=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../../Engine/Collections/Array2");function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=function(e){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t));return r.forEach(function(e,t,n){r.data[t][n]=[]}),r.offsetX=[0,-1,0,1,1,1,0,-1,-1],r.offsetY=[0,-1,-1,-1,0,1,1,1,0],r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i.Array2),r(n,[{key:"clear",value:function(){this.forEach(function(e){e.splice(0,e.length)})}},{key:"neighbours",value:function(e,t){for(var n=[],r=0;r<9;r++){var i=e+this.offsetX[r],o=t+this.offsetY[r];0<=i&&i<this.width&&0<=o&&o<this.height&&n.push.apply(n,a(this.data[i][o]))}return n}}]),n}();n.ArrayGrid=o},{"../../../../Engine/Collections/Array2":1}],47:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParticlesFlyerView=n.ParticlesFlyer=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../ParticleSystem"),o=e("../../../../Engine/Numerics/Random"),a=e("../../../../Engine/Game/GameComponents/Effect/Effect"),l=e("../../../../Engine/UI/Color"),f=e("../../../../Engine/Numerics/Vector2"),s=e("./ArrayGrid"),u=e("../../../../Engine/Game/GameObject/GameView"),c=e("../../../../Engine/Drawing/Graphics"),h=e("../Particle/FlyerParticle");function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=function(e){function n(e){p(this,n);var t=d(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.random=new o.Random,t.start.next(t._start),t.update.next(t._update),t.proxy(new a.GhostEffect(new l.Color(0,128,128,.005),40)),t}return y(n,i.ParticlesBase),r(n,[{key:"_start",value:function(){var e=this.world.width,t=this.world.height,n=new f.Vector2(.5*e,.5*t);this.flyers=[];for(var r=new f.Vector2(e,t).length(),i=parseInt(r/5),o=parseInt(r/60),a=.8*e,s=.8*t,u=0;u<i;u++){var c=new h.FlyerParticle;c.location=n.add(new f.Vector2(a*Math.random()-a/2,s*Math.random()-s/2)),c.velocity=new f.Vector2(10*Math.random()-5,10*Math.random()-5),c.size=2+o*Math.random(),c.color=l.Colors.White,this.flyers.push(c)}this.particles=this.flyers,this.revolution=20,this.grid=this.createGrid(e,t,this.revolution),0===this.world.inputs.pointer.position.length()&&(this.world.inputs.pointer.position=new f.Vector2(e/2,t/2))}},{key:"_update",value:function(){var i=this,o={width:this.world.width,height:this.world.height};this.grid.clear(),this.allocateGrid(this.grid,this.particles,this.revolution),this.grid.forEach(function(e,t,n){if(0<e.length){var r=i.grid.neighbours(t,n);e.forEach(function(e){e.update(r,o,i.world.inputs.pointer.position)})}})}},{key:"createGrid",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:10,r=Math.ceil(e/n),i=Math.ceil(t/n);return new s.ArrayGrid(r,i)}},{key:"allocateGrid",value:function(n,e){var r=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:10;e.forEach(function(e){var t=r.mapLocation(e.location,i);n.get(t.x,t.y).push(e)})}},{key:"mapLocation",value:function(e,t){var n=Math.floor(e.x/t),r=Math.floor(e.y/t);return new f.Vector2(n,r)}}]),n}(),m=function(e){function t(){p(this,t);var e=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.rotation=0,e}return y(t,u.GameView),r(t,[{key:"draw",value:function(e,t){if(!this.target.stopDraw){this.rotation=this.rotation+.002;var n=16*Math.sin(this.rotation);c.Graphics.offsetScale(t,n,n,.99);for(var r=0;r<this.target.particles.length;r++){var i=this.target.particles[r],o=i.location;t.beginPath(),t.arc(o.x,o.y,i.size/2,0,2*Math.PI,!1),t.closePath(),t.fillStyle=i.color.rgba,t.fill()}}}}]),t}();n.ParticlesFlyer=v,n.ParticlesFlyerView=m},{"../../../../Engine/Drawing/Graphics":10,"../../../../Engine/Game/GameComponents/Effect/Effect":14,"../../../../Engine/Game/GameObject/GameView":15,"../../../../Engine/Numerics/Random":21,"../../../../Engine/Numerics/Vector2":23,"../../../../Engine/UI/Color":24,"../Particle/FlyerParticle":50,"../ParticleSystem":53,"./ArrayGrid":46}],48:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Particle=void 0;var i=e("../../../Engine/UI/Color");n.Particle=function e(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.location=t,this.size=n,this.age=r,this.color=new i.Color(0,0,0,1),this.dead=!1}},{"../../../Engine/UI/Color":24}],49:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DynamicParticle=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("../Particle"),a=e("../../../../Engine/Numerics/Vector2");var i=function(e){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t,n));return r.velocity=new a.Vector2(0,0),r.acceleration=new a.Vector2(0,0),r.mass=10,r.velocityUpon=Number.POSITIVE_INFINITY,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,o.Particle),r(i,[{key:"applyForce",value:function(e){this.acceleration=this.acceleration.add(e.divide(this.mass))}},{key:"move",value:function(){this.velocity=this.velocity.add(this.acceleration),this.velocity.limitLength(this.velocityUpon),this.location=this.location.add(this.velocity),this.acceleration=new a.Vector2(0,0)}},{key:"moveTo",value:function(e){this.location=e,this.velocity.setLength(0)}}]),i}();n.DynamicParticle=i},{"../../../../Engine/Numerics/Vector2":23,"../Particle":48}],50:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.FlyerParticle=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("./DynamicParticle"),s=e("../../../../Engine/Numerics/Vector2");var i=function(e){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t,n));return r.velocityUpon=3,r.neighbourDistance=200,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,o.DynamicParticle),r(i,[{key:"update",value:function(e,t,n){this.alignspeed(e),this.seperate(e),this.cohesion(e),this.follow(n,.5),this.checkRadius(n,new s.Vector2(t.width,t.height).length()/3),this.move(),this.checkBorder(t)}},{key:"alignspeed",value:function(e){var t=this,n=new s.Vector2,r=0;if(e.forEach(function(e){t.location.subtract(e.location).length()<t.neighbourDistance&&(n=n.add(e.velocity),r++)}),0<r){(n=n.divide(r)).limitLength(this.velocityUpon);var i=n.subtract(this.velocity);i.limitLength(1),this.applyForce(i)}}},{key:"seperate",value:function(e){var i=this,o=new s.Vector2,a=0;if(e.forEach(function(e){var t=i.location.subtract(e.location),n=t.length(),r=(i.size+e.size)/2+5;0<n&&n<r&&(t.normalize(),t.divide(n),o=o.add(t),a++)}),0<a){(o=o.divide(a)).normalize(),o.multiply(this.velocityUpon);var t=o.subtract(this.velocity);t.limitLength(10),this.applyForce(t)}}},{key:"cohesion",value:function(e){var t=this,n=new s.Vector2,r=0;if(e.forEach(function(e){t.location.subtract(e.location).length()<t.neighbourDistance&&(n=n.add(e.location),r++)}),0<r){n=n.divide(r);var i=this.seek(n);i.limitLength(.1),this.applyForce(i)}}},{key:"follow",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;this.applyForce(this.seek(e).multiply(t))}},{key:"checkRadius",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,n=this.location.subtract(e).length(),r=175+80*Math.max(.1,Math.min(1,1-n/t)),i=this.color.r+.5*Math.sign(r-this.color.r);this.color.r=this.color.g=this.color.b=i}},{key:"checkBorder",value:function(e){var t=this.location,n=e.width,r=e.height,i=this.size/2+10,o=this.size/2+10;t.x<i?(t.x=i,this.velocity.x*=-1):t.x>n-i&&(t.x=n-i,this.velocity.x*=-1),t.y<o?(t.y=o,this.velocity.y*=-1):t.y>r-o&&(t.y=r-o,this.velocity.y*=-1)}},{key:"seek",value:function(e){return this._seek(this.location,e,this.velocity)}},{key:"_seek",value:function(e,t,n){var r=t.subtract(e);r.normalize(),r.multiply(this.velocityUpon);var i=r.subtract(n);return i.limitLength(1),i}}]),i}();n.FlyerParticle=i},{"../../../../Engine/Numerics/Vector2":23,"./DynamicParticle":49}],51:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SpotParticle=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("./DynamicParticle"),a=e("../../../../Engine/Numerics/Random"),s=e("../../../../Engine/Numerics/Vector2"),u=e("../../../../Engine/UI/Color");var o=function(e){function o(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,e,t,n));return r.angleOffset=.03*Math.random()-.015,r.velocityUpon=16,r.random=new a.Random,r.sizeMinimum=1,r.sizeRadius=.995,r.rotateRadius=.01,r.rotateRadiusRandom=.001,r.divideRadius=.03,r.divideSizeRadius=.8,r.divideSizeRadiusEx=.92,r.divideColorIncrementRatio=4,r.getGradientColorIncrement=1,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(o,i.DynamicParticle),r(o,[{key:"update",value:function(e,t){0<this.age&&(this.age-=1,this.size=this.size*this.sizeRadius,this.velocity=this.velocity.rotate(this.angleOffset*this.rotateRadius),this.velocity=this.velocity.rotate(this.random.normal(-100,100)*this.rotateRadiusRandom),this.color=u.ColorHelper.gradient(this.color,this.getGradientColorIncrement),this.velocityUpon=.38*this.size,this.move(),this.color.a-=.002,this.color.a=Math.max(0,this.color.a)),this.size>this.sizeMinimum?Math.random()<this.divideRadius&&this.divide(e,t):(this.velocity=new s.Vector2(0,0),this.isDead=!0)}},{key:"divide",value:function(e,t){t<2&&(t=2);var n=this.size*this.divideSizeRadius;if(this.size=n,this.age=this.random.normal(0,30),this.angleOffset=.02*Math.random()-.01,1<t)for(var r=2;r<=t;r++){n*=this.divideSizeRadiusEx;var i=new o(this.location,n);i.velocity=this.velocity.rotate(.011*this.random.normal(-100,100)).multiply(.618),i.age=this.random.normal(0,40),i.color=u.ColorHelper.gradientRandom(this.color,this.velocity.length()*this.divideColorIncrementRatio),e.push(i)}}}]),o}();n.SpotParticle=o},{"../../../../Engine/Numerics/Random":21,"../../../../Engine/Numerics/Vector2":23,"../../../../Engine/UI/Color":24,"./DynamicParticle":49}],52:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.WalkerParticle=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("./DynamicParticle"),o=e("../../../../Engine/Numerics/Random");var a=function(e){function s(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,e,t,n));return r.random=new o.Random,r.maxSize=1,r.maxAge=300,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(s,i.DynamicParticle),r(s,[{key:"update",value:function(e,t){this.age<this.maxAge&&(this.age+=1,this.size=this.maxSize*this.age/this.maxAge,this.mass=this.size*this.size*this.size,this.velocityUpon=this.size/2);var n=t.subtract(this.location),r=n.length();if(r<this.size/2)this.age=0,this.size=1,this.mass=1,this.location=this.origin.clone();else{var i=n.normalize(),o=s.StaticGravityRatio||0,a=i.multiply(this.mass/(r*r)*o);this.applyForce(a)}this.move()}}]),s}();n.WalkerParticle=a},{"../../../../Engine/Numerics/Random":21,"./DynamicParticle":49}],53:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParticlesBase=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../Engine/Game/GameObject/GameVisual");var o=function(e){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.particles=[],t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i.GameVisual),r(n,[{key:"killDead",value:function(){var e=this.particles.length;if(0<e)for(var t=e-1;0<=t;t--){this.particles[t].dead&&this.particles.splice(t,1)}}}]),n}();n.ParticlesBase=o},{"../../../Engine/Game/GameObject/GameVisual":16}],54:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParticlesTreeView=n.ParticlesTree=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../../../Engine/UI/Color"),o=e("../../../../Engine/Numerics/Vector2"),a=e("../../../../Engine/Numerics/Random"),s=e("../ParticleSystem"),u=e("../Particle/SpotParticle"),c=e("../../../../Engine/Game/GameObject/GameView");function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(e){function n(e){l(this,n);var t=f(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.spots=[],t.random=new a.Random,t.start.next(t._start),t.update.next(t._update),t}return h(n,s.ParticlesBase),r(n,[{key:"_start",value:function(){var e=Math.min(this.world.width,this.world.height),t=e/2500*Math.log10(e),n=new o.Vector2(this.world.width/2,1.45*this.world.height),r=new u.SpotParticle(n);r.velocity=new o.Vector2(0,-16*t),r.size=256*t,r.age=30,r.color=new i.Color(10,10,10),this.spots.push(r),this.particles=this.spots}},{key:"_update",value:function(){if(!this.stopDraw)if(6e4<this.spots.length)this.stopDraw=!0;else if(0<this.spots.length){for(var e=0;e<this.spots.length;e++){this.particles[e].update(this.spots,Math.ceil(this.random.normal(1,3)))}this.killDead(this.spots)}}}]),n}(),d=function(e){function t(){return l(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h(t,c.GameView),r(t,[{key:"draw",value:function(e,t){this.target.stopDraw||this.drawByFillCircle(t)}},{key:"drawByFillCircle",value:function(e){for(var t=2*Math.PI,n=0;n<this.target.particles.length;n++){var r=this.target.particles[n],i=r.location;e.beginPath(),e.arc(i.x,i.y,r.size/2,0,t,!1),e.fillStyle=r.color.rgba,e.fill()}}}]),t}();n.ParticlesTree=p,n.ParticlesTreeView=d},{"../../../../Engine/Game/GameObject/GameView":15,"../../../../Engine/Numerics/Random":21,"../../../../Engine/Numerics/Vector2":23,"../../../../Engine/UI/Color":24,"../Particle/SpotParticle":51,"../ParticleSystem":53}],55:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParticlesWalkerView=n.ParticlesWalker=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),u=e("../../../../Engine/UI/Color"),i=e("../../../../Engine/Numerics/Vector2"),o=e("../../../../Engine/Numerics/Random"),a=e("../ParticleSystem"),c=e("../Particle/WalkerParticle"),s=e("../../../../Engine/Numerics/Transform"),l=e("../../../../Engine/Game/GameComponents/Effect/Effect"),f=e("../../../../Engine/Game/GameObject/GameView"),h=e("../../../../Engine/Drawing/Graphics");function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=function(e){function n(e){p(this,n);var t=d(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.random=new o.Random,t.start.next(t._start),t.update.next(t._update),t.transform=new s.Transform,t.proxy(new l.GhostEffect(new u.Color(0,128,128,.003),40)),t}return y(n,a.ParticlesBase),r(n,[{key:"_start",value:function(){var e=this.world.width,t=this.world.height;this.walkers=[],this.split=1;var n=new i.Vector2(e/2,.8*t);this.center=n,c.WalkerParticle.StaticGravityRatio=5e3;var r=new c.WalkerParticle(n);r.origin=r.location.clone(),r.maxSize=10,r.color=new u.Color(255,255,255,.1),r.direction=new i.Vector2(0,-this.world.width/10),this.walkers.push(r),this.maxDepth=6+parseInt(e/600),this.createNodes(this.walkers,r,this.maxDepth,this.split,1),this.rotationDelta=2*Math.PI/Math.floor(8*Math.random()+2),this.particles=this.walkers}},{key:"_update",value:function(){var n=this,r={width:this.world.width,height:this.world.height};this.transform.center=new i.Vector2(r.width/2,r.height/2),this.transform.rotation=this.transform.rotation+this.rotationDelta,this.walkers.forEach(function(e,t){e.update(r,0===t?n.center:e.parent.location)}),.5<Math.random()&&(this.split+=1.6*Math.random()-.8,this.split=Math.max(1,Math.min(16,this.split))),this.modifyNodes(this.walkers[0],this.split,1*this.split/10)}},{key:"createNodes",value:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1;if(0<n){var o=[-1,1,0];t.children=[];for(var a=0;a<2;a++){var s=new c.WalkerParticle;s.direction=t.direction.rotate(Math.PI/r*o[a]),s.location=t.location.add(s.direction.multiply(i)),s.origin=s.location.clone(),s.parent=t,s.maxSize=.8*t.maxSize,s.color=new u.Color(255,255,255,1/this.maxDepth-.05*n),t.children.push(s),this.walkers.push(s),this.createNodes(e,s,n-1,r,i)}}}},{key:"modifyNodes",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;if(e.children&&0<e.children.length)for(var r=[-1,1,0],i=0;i<2;i++){var o=e.children[i];o.direction=e.direction.rotate(Math.PI/t*r[i]),o.origin=e.origin.add(o.direction.multiply(n)),this.modifyNodes(o,t,n)}}}]),n}(),m=function(e){function t(){return p(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,f.GameView),r(t,[{key:"draw",value:function(e,r){var i=this;this.target.stopDraw||h.Graphics.transform(r,this.target.transform.toMatrix3x2(),function(){for(var e=0;e<i.target.particles.length;e++){var t=i.target.particles[e],n=t.location;t.parent&&(r.beginPath(),r.moveTo(n.x,n.y),r.lineTo(t.parent.location.x,t.parent.location.y),r.lineWidth=t.size,r.strokeStyle=t.color.rgba,r.closePath(),r.stroke())}})}}]),t}();n.ParticlesWalker=v,n.ParticlesWalkerView=m},{"../../../../Engine/Drawing/Graphics":10,"../../../../Engine/Game/GameComponents/Effect/Effect":14,"../../../../Engine/Game/GameObject/GameView":15,"../../../../Engine/Numerics/Random":21,"../../../../Engine/Numerics/Transform":22,"../../../../Engine/Numerics/Vector2":23,"../../../../Engine/UI/Color":24,"../Particle/WalkerParticle":52,"../ParticleSystem":53}],56:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParticlesFlyerWorld=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Game/GameWorld/GameWorld"),o=e("../../Engine/Game/GameWorld/GameWorldView"),a=e("../../Engine/Common/Inputs"),s=e("./ParticleSystem/Flyer/ParticlesFlyer");var u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GameWorld),r(t,[{key:"initialize",value:function(){this.bind(new o.GameWorldView),this.inputs.addInput(new a.PointerInput)}},{key:"createObjects",value:function(){this.addVisual(new s.ParticlesFlyer,new s.ParticlesFlyerView)}}],[{key:"Title",get:function(){return"Particles - Flyer"}}]),t}();n.ParticlesFlyerWorld=u},{"../../Engine/Common/Inputs":6,"../../Engine/Game/GameWorld/GameWorld":17,"../../Engine/Game/GameWorld/GameWorldView":18,"./ParticleSystem/Flyer/ParticlesFlyer":47}],57:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParticlesTreeWorld=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Game/GameWorld/GameWorld"),o=e("../../Engine/Game/GameWorld/GameWorldView"),a=e("./ParticleSystem/Tree/ParticlesTree");var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GameWorld),r(t,[{key:"initialize",value:function(){this.bind(new o.GameWorldView)}},{key:"createObjects",value:function(){this.addVisual(new a.ParticlesTree,new a.ParticlesTreeView)}}],[{key:"Title",get:function(){return"Particles - Tree"}}]),t}();n.ParticlesTreeWorld=s},{"../../Engine/Game/GameWorld/GameWorld":17,"../../Engine/Game/GameWorld/GameWorldView":18,"./ParticleSystem/Tree/ParticlesTree":54}],58:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParticlesWalkerWorld=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=e("../../Engine/Game/GameWorld/GameWorld"),o=e("../../Engine/Game/GameWorld/GameWorldView"),a=e("../../Engine/Common/Inputs"),s=e("./ParticleSystem/Walker/ParticlesWalker");var u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.GameWorld),r(t,[{key:"initialize",value:function(){this.bind(new o.GameWorldView),this.inputs.addInput(new a.PointerInput)}},{key:"createObjects",value:function(){this.addVisual(new s.ParticlesWalker,new s.ParticlesWalkerView)}}],[{key:"Title",get:function(){return"Particels - Walker"}}]),t}();n.ParticlesWalkerWorld=u},{"../../Engine/Common/Inputs":6,"../../Engine/Game/GameWorld/GameWorld":17,"../../Engine/Game/GameWorld/GameWorldView":18,"./ParticleSystem/Walker/ParticlesWalker":55}],59:[function(e,t,n){"use strict";n.__esModule=!0;var r,i=e("./Gallery/GalleryStarter"),o=document.getElementById("canvas"),a=document.getElementById("button-rebuild"),s=document.getElementById("text-frame");function u(){o.width=document.body.clientWidth,o.height=document.body.clientHeight,(r=(new i.GalleryStarter).launch(o)).frameManager.onRateChanged=function(e){s&&(s.innerText="FPS:"+e)},r.run()}window.addEventListener("resize",function(){r.stop(),u()}),a.addEventListener("click",function(){r.stop(),u()}),u()},{"./Gallery/GalleryStarter":27}]},{},[59]);